(function(){var Form=function(api){if(void 0===api)return alert("Error: Please pass KonnekApiInit() function as parameter to KonnekForm() function."),!1;var form_obj={},withPixel=!1,api=api,wasSubmitted=!1,error_msg="",additional_params="",checkoutType=api.getCheckoutType(),coupon_code="",currencySymbol="$",billerNameDomain="",ty_data;form_obj.listUpsells=[],form_obj.psmr_ok=!1;var geo_options={initialCountry:"auto",geoIpLookup:function(e){$.get("https://www.cloudflare.com/cdn-cgi/trace").always((function(t){var i=(t=t.trim().split("\n").reduce((function(e,t){return e[(t=t.split("="))[0]]=t[1],e}),{})).loc?t.loc:"US";!function e(){$("#fields_country_select option").length>1?0!=$("#fields_country_select option[value='"+i+"']").length&&$("#fields_country_select").val(i).trigger("change").trigger("mouseup"):setTimeout(e,500)}(),e(i)}))},separateDialCode:!0,utilsScript:"/onlineorder/js/konnek.api/build/js/utils.js"},iti;function removeExtraSpaces(e){return e.replace(/\s+/g," ")}function addYears(e,t){var i=parseInt((new Date).getFullYear()),r=i+t,a=-1;for($(e).empty(),$(e).append($("<option></option>").val("").html("YEAR"));i<=r;)a=String(i).length-2,$(e).append($("<option></option>").val(String(i).substr(a)).html(i)),i++}function addMonths(e){var t=new Array("(Jan)","(Feb)","(Mar)","(Apr)","(May)","(Jun)","(Jul)","(Aug)","(Sep)","(Oct)","(Nov)","(Dec)"),r="";for($(e).empty(),$(e).append($("<option></option>").val("").html("MONTH")),i=0;i<t.length;i++)r=1==String(i+1).length?"0"+String(i+1):String(i+1),$(e).append($("<option></option>").val(r).html(r+" "+t[i]))}function addCountries(e,t){$("#fields_country_select, #fields_country_select2").empty(),e.length>1&&$("#fields_country_select, #fields_country_select2, #fields_country_select_bill").append($("<option></option>").val("").html("-- Country--")),$.each(e,(function(t,i){"CurrencyAbbreviation"!=t&&"CurrencyPrefix"!=t&&"ExchangeRate"!=t&&(1!=e.length?($("#fields_country_select, #fields_country_select2, #fields_country_select_bill").append($("<option></option>").val(e[t].countryCode).html(e[t].countryName)),FormSubmitValidation($.trim($("#fields_country_select").val()),!0),$("#fields_country_select_bill").length>0&&FormSubmitValidation($.trim($("#fields_country_select_bill").val()),!0)):(0==$("#fields_country").length&&$("form:first").append('<input type="hidden" id="fields_country" name="fields_country" value=""/>'),$("#fields_country").val(t),$("#fields_country_select > option").length<1&&($("#fields_country_select").append($("<option/>").val(e[t].countryCode).html(e[t].countryName)),FormSubmitValidation($.trim($("#fields_country").val())))))})),addStatesProvince("#fields_state, #fields_state_bill")}function addStatesProvince(e){var t;if($("#fields_country").length>0&&0==$("#fields_country_select").length&&null!=$("#fields_country").val())t=$("#fields_country").val().toUpperCase();else if(""!=$.trim(getQueryStringByName("fields_country")))t=$.trim(getQueryStringByName("fields_country"));else if($("#fields_country_select").length>0){if(!$("#fields_country_select").val())return $(e+", #fields_state2").empty(),$(e+", #fields_state2").append($("<option></option>").val("").html("Select a country")),void $("#fields_country_select, #fields_country_select2, #fields_country_select_bill").on("change",(function(){addStatesProvince(e);var t=this.value;FormSubmitValidation(t,!0),0==$("#fields_country").length?$("form").append('<input type="hidden" id="fields_country" name="fields_country" value=""/>').promise().done((function(){$("#fields_country").val(t)})):$("#fields_country").val(this.value)}));t=$("#fields_country_select").val().toUpperCase()}if($(e).empty(),$(e).append($("<option></option>").val("").html("-- Select --")),$(States).each((function(i,r){$.each(r,(function(i,r){i==t&&$.each(r,(function(t,i){$.each(i,(function(t,i){$(e).append($("<option></option>").val(t).html(i))}))}))}))})),$("#fields_state2").length>0){$("#fields_state2").empty();var i=$(e).html();$("#fields_state2").html(i)}}function PreFillForm(){if(""!=getQueryStringByName("field_fn")&&-1==getQueryStringByName("field_fn").indexOf("{"))$("#fields_fname").val(getQueryStringByName("field_fn")),$("#fields_lname").val(getQueryStringByName("field_ln")),""!=getQueryStringByName("address1")?$("#fields_address1").val(getQueryStringByName("address1")):$("#fields_address1").val(getQueryStringByName("field_address")),$("#fields_city").val(getQueryStringByName("field_city")),$("#fields_zip").val(getQueryStringByName("field_zip")),setTimeout((function(){$("#fields_state").val(getQueryStringByName("field_state"))}),1e3),$("#fields_phone").val(getQueryStringByName("field_phone")),$("#fields_email").val(getQueryStringByName("field_email"));else if(-1==getQueryStringByName("fields_fname").indexOf("{")&&""!=getQueryStringByName("fields_fname")&&($("#fields_fname").val(getQueryStringByName("fields_fname")),$("#fields_lname").val(getQueryStringByName("fields_lname")),$("#fields_email").val(getQueryStringByName("fields_email")),1!=getQueryStringByName("retcus"))){if(""!=getQueryStringByName("fields_address1")?$("#fields_address1").val(getQueryStringByName("fields_address1")):$("#fields_address1").val(getQueryStringByName("field_address")),""!=getQueryStringByName("fields_address2")&&$("#fields_address2").val(getQueryStringByName("fields_address2")),""!=getQueryStringByName("fields_country")&&$("#fields_country, #fields_country_select").val(getQueryStringByName("fields_country")),$("#fields_city").val(getQueryStringByName("fields_city")),$("#fields_zip").val(getQueryStringByName("fields_zip")),getQueryStringByName("fields_zip").indexOf("-")>-1&&$("#fields_zip").length>0){var e="#fields_zip";$("#fields_zip").length>0&&(e+=" #fields_zip2"),$(e).rules("remove","validZipcode"),$(e).attr("maxlength",10),$(e).rules("add",{maxlength:10})}setTimeout((function(){$("#fields_state").val(getQueryStringByName("fields_state"))}),1e3),$("#fields_phone").val(getQueryStringByName("fields_phone"))}-1==getQueryStringByName("fields_fname").indexOf("{")&&""!=getQueryStringByName("fields_fname")&&($("#fields_fname_bill").val(getQueryStringByName("fields_fname")),$("#fields_lname_bill").val(getQueryStringByName("fields_lname")),$("#fields_email_bill").val(getQueryStringByName("fields_email")),1!=getQueryStringByName("retcus")&&(""!=getQueryStringByName("fields_address1")?$("#fields_address1_bill").val(getQueryStringByName("fields_address1")):$("#fields_address1_bill").val(getQueryStringByName("field_address")),""!=getQueryStringByName("fields_address2")&&$("#fields_address2_bill").val(getQueryStringByName("fields_address2")),$("#fields_city_bill").val(getQueryStringByName("fields_city")),$("#fields_zip_bill").val(getQueryStringByName("fields_zip")),setTimeout((function(){$("#fields_state_bill").val(getQueryStringByName("fields_state"))}),1e3),$("#fields_phone_bill").val(getQueryStringByName("fields_phone")),$("#fields_fname_bill, #fields_lname_bill, #fields_email_bill, #fields_phone_bill").prop("disabled",!1)))}function ExpEntrZip_Key(e){$(e).unbind("keydown"),$(e).keydown((function(e){173==e.keyCode&&1==($(this).val().match(/-/g)||[]).length&&e.preventDefault(),-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,173])||65==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}))}function line_loaderCss(){var e=document.createElement("link");e.setAttribute("id","lineLoader"),e.href="/onlineorder/js/konnek.api/loader.css",e.rel="stylesheet",0==$("#lineLoader").length&&document.head.appendChild(e)}function testingDisplay(){if("test"==getQueryStringByName("konnektiveTest")){$("div#testing").remove();var e=document.createElement("style");e.setAttribute("id","devTesting"),e.innerText="div#testing{background:rgba(0, 0, 0, 0.5);position:fixed;width:40%;top:0;z-index:1000}#testing table {border: 1px solid #ccc;border-collapse: collapse;margin: 0;padding: 0;width: 100%;table-layout: fixed;}#testing div {font-size: 1em;text-align:center;color:white;}#testing table tr {background-color: rgba(255, 255, 255, 0.9);border: 1px solid #ddd;padding: .35em;}#testing table th, #testing table td {padding: .625em;text-align: center;}#testing table th {font-size: .85em;letter-spacing: .1em;text-transform: uppercase;}@media screen and (max-width: 600px) {div#testing{top:unset;width:100%;bottom:0;}#testing table {border: 0;}#testing table caption {font-size: 1em;}#testing table thead {border: none;clip: rect(0 0 0 0);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#testing table tr {border-bottom: 3px solid #ddd;display: block;margin-bottom: .625em;}#testing table td {border-bottom: 1px solid #ddd;display: block;font-size: .6em;text-align: right;}#testing table td::before {content: attr(data-label);float: left;font-weight: bold;text-transform: uppercase;}#testing table td:last-child {border-bottom: 0;}}".toString(),0==$("#devTesting").length&&document.head.appendChild(e);var t='<div id="testing">\n                            <div>Item(s) Selected</div>\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th scope="col">Prod Name</th>\n                                        <th scope="col">Price</th>\n                                        <th scope="col">Ship Price</th>\n                                        <th scope="col">Billing Type</th>\n\n                                    </tr>\n                                </thead>\n                            <tbody>';$("input[type='hidden'].konnecktive-order").each((function(){var e=$("input.product-option[campaignproductid='"+$(this).val()+"']");0!=e.length&&0!=$("#productOption-container input[type='radio'].product-selected").length&&(t+='<tr>\n                            <td data-label="Prod Name">'+e.attr("product-name")+'</td>\n                            <td data-label="Price">'+$(this).attr("price")+'</td>\n                            <td data-label="Shipping">'+$(this).attr("shippingprice")+'</td>\n                            <td data-label="Billing Type">'+e.attr("billingcycletype")+"</td>\n\n                        </tr>")})),0==$("#productOption-container input[type='radio'].product-selected").length&&(t+='<tr>\n                                <td data-label="Prod Name" style="color:red;" colspan="3">No Product Option Selected</td>\n                              </tr>'),t+="</tbody>\n                        </table>\n                        </div>",$("body:first").append(t)}}function showStraightSaleOption(){var e="prepaid-option-modal";if($("#"+e+" .close-pop").click((function(){$("#"+e).trigger("closeModal")})),$(".ss_price").html($("input.product-option[campaignproductid='"+api.get_ss_id()+"']").attr("price")),$("#"+e).length>0)$("#"+e).easyModal({overlay:.4,overlayClose:!1,closeOnEscape:!1,autoOpen:!0,onOpen:function(){$("#"+e).css({zIndex:99999}),$("#"+e+" .btn-non-prepaid-card").unbind("click"),$("#"+e+" .btn-non-prepaid-card").bind("click",(function(t){$("#"+e).trigger("closeModal"),t.preventDefault()})),$("#"+e+" .btn-continue-non-trial").unbind("click"),$("#"+e+" .btn-continue-non-trial").bind("click",(function(t){$("input.product-option[campaignproductid='"+api.get_ss_id()+"']").trigger("mouseup"),$("#"+e).trigger("closeModal"),$("form").submit(),t.preventDefault()}))},updateZIndexOnOpen:!1,zIndex:function(){return 100}});else{var t='<div id="'+e+'" style="font-family:arial;color:#000;display:none;background:rgb(40, 40, 40);padding: 12px;border-radius: 13px;"><p style="color:white!important;">Unfortunately, we are unable to accept prepaid cards for trial offers,<br/>But we don\'t want you to miss out on this amazing deal!</p><br/><br/><div style="text-align:center;"><input type="button" class="btn-continue-non-trial" style="padding:10px!important;" value="Continue with non-trial offer">&nbsp;&nbsp;<input type="button" class="btn-non-prepaid-card" style="padding:10px!important;" value="Enter non-prepaid card"></div></div>';$("body").append(t).promise().done((function(){$("#"+e).easyModal({overlay:.4,overlayClose:!1,closeOnEscape:!1,autoOpen:!0,onOpen:function(){$("#"+e).css({zIndex:99999}),$("#"+e+" .btn-non-prepaid-card").unbind("click"),$("#"+e+" .btn-non-prepaid-card").bind("click",(function(t){$("#"+e).trigger("closeModal"),t.preventDefault()})),$("#"+e+" .btn-continue-non-trial").unbind("click"),$("#"+e+" .btn-continue-non-trial").bind("click",(function(t){$("input.product-option[campaignproductid='"+api.get_ss_id()+"']").trigger("mouseup"),$("#"+e).trigger("closeModal"),$("form").submit(),t.preventDefault()}))},updateZIndexOnOpen:!1,zIndex:function(){return 100}})}))}}function warranty(){if(0!=api.get_warranty_prod_id()&&"upsell"!=getQueryStringByName("fields_step")&&"thankyou"!=getQueryStringByName("fields_step")){var e=$('input.product-option[campaignproductid="'+api.get_warranty_prod_id()+'"]');if(void 0===e.attr("campaignproductid"))return!1;$(".warranty-price").html(e.attr("price")),$(document).on("click","#warranty",(function(){$("#warranty").is(":checked")?($(".warranty-container").show(),0==$("#warranty-data").length&&$("<input>",{type:"hidden",class:"konnecktive-order",id:"warranty-data",value:e.attr("campaignproductid"),price:e.attr("actual_price"),qty:e.attr("productqty"),shippingprice:e.attr("shipping-price"),productName:e.attr("product-name")}).insertAfter("#prod_id")):($("input#warranty-data").remove(),$(".warranty-container").hide()),form_obj.totalAmount()}))}}function populateProductOffer(e){$("#productOption-container, #pay_source").remove(),0==$("#productOption-container").length&&($("form:first").prepend("<div style='display:none!important;' id='productOption-container'></div>"),0==$("form").length&&$("body:first").prepend("<div style='display:none!important;' id='productOption-container'></div>")),0==$("#prod_id").length?($("form:first").append('<input type="hidden" id="prod_id" class="konnecktive-order" name="product_id" value=""/>'),0==$("form").length&&$("body:first").append('<input type="hidden" id="prod_id" class="konnecktive-order" name="product_id" value=""/>')):$("#prod_id").addClass("konnecktive-order"),0!=$("#pay_source").length||""!=getQueryStringByName("fields_step")&&"second"!=getQueryStringByName("fields_step")||($("form:first").prepend('<input type="hidden" id="pay_source" name="pay_source" value="creditcard"/>'),0==$("form").length&&$("body:first").prepend('<input type="hidden" id="pay_source" name="pay_source" value="creditcard"/>'));var t=0,i=1,r=""==billerNameDomain?getQueryStringByName("billerNdomain"):billerNameDomain,a=0;for(var n in e)if(""!=r&&-1==e[n].billerName.toLowerCase().indexOf(r.toLowerCase())&&-1==e[n].baseProductName.toLowerCase().indexOf("psmr"));else{""!=r&&-1!=e[n].billerName.toLowerCase().indexOf(r.toLowerCase())&&a++;var o=e[n].maxOrderQty;null!=e[n].maxOrderQty&&""!=e[n].maxOrderQty||(o=1);var s=parseFloat(e[n].price)*parseInt(o),l=parseFloat(e[n].shippingPrice)*parseInt(o);$(".currency").html(currencySymbol),$(".prod_id"+e[n].campaignProductId+"_price, [data-hierarchy="+i+"] .price").html(currencySymbol+s.toFixed(2)),$(".prod_id"+e[n].campaignProductId+"_shipping, [data-hierarchy="+i+"] .shipping-price").html(currencySymbol+l.toFixed(2)),$(".prod_id"+e[n].campaignProductId+"_price2, [data-hierarchy="+i+"] .price2").html(s.toFixed(2)),$(".prod_id"+e[n].campaignProductId+"_shipping2, [data-hierarchy="+i+"] .shipping-price2").html(l.toFixed(2)),$("[data-hierarchy="+i+"]").attr("prodx-quantity",o),$("<input>",{type:"radio",class:"product-option",name:"product-offers","data-hierarchy":i,campaignProductId:e[n].campaignProductId,"product-name":e[n].productName,"product-Type":e[n].productType,price:s.toFixed(2),actual_price:e[n].price,"shipping-price":e[n].shippingPrice,"shipping-price-x-qty":l.toFixed(2),productQty:o,baseProductName:e[n].baseProductName,productSku:e[n].productSku,productDescription:e[n].productDescription,billerName:e[n].billerName,billingCycleType:e[n].billingCycleType,billerId:e[n].billerId,mouseup:function(){$("input[type='radio'].product-options").removeClass("product-selected"),$(this).addClass("product-selected"),$("#prod_id").val($(this).attr("campaignProductId")).addClass("konnecktive-order"),$(".product-price").text(currencySymbol+$(this).attr("price")),$(".prod-shipping-price").text(currencySymbol+$(this).attr("shipping-price-x-qty")),$(".product-price2").text($(this).attr("price")),$(".prod-shipping-price2").text($(this).attr("shipping-price-x-qty")),$("#prod_id").attr({price:$(this).attr("actual_price"),qty:$(this).attr("productQty"),shippingPrice:$(this).attr("shipping-price"),productName:$(this).attr("product-name"),billingcycle:$(this).attr("billingCycleType"),billerId:$(this).attr("billerId"),billerName:$(this).attr("billerName")}),$(".coupon-wrapper").show(),$(".congrats-wrapper, .congrats-wrapper-priority").hide(),$(".discount-container").hide(),$("#totalDiscount_applied").remove(),$(".fields_coupon, #fields_coupon").val(""),void 0!==$.cookie("CouponCode")&&($.cookie("ProductOptionID")!=$(this).attr("campaignProductId")?$.removeCookie("CouponCode"):($("#fields_coupon").val($.cookie("CouponCode")),$("#btnCoupon").trigger("click"))),$.cookie("ProductOptionID",$(this).attr("campaignProductId")),form_obj.totalAmount()}}).appendTo("#productOption-container"),t++,i++}if(warranty(),""!=r&&0==a&&alert("ERROR: Campaign doesn't have assigned product(s) with billername/gateway containing the domain name: "+r),(""==getQueryStringByName("campaignId")||"second"==getQueryStringByName("fields_step"))&&0==$("#is_intro").length&&-1==location.pathname.toLowerCase().indexOf("/shared_pages/")&&-1==location.pathname.toLowerCase().indexOf("upsell.html")&&checkDefinedIds())return window.location.href="index.html",!1;1==t?$("#productOption-container input").eq(0).trigger("mouseup"):0!=$("#prod_id").length&&(0!=$("input.product-option[campaignproductid='"+$("#prod_id").val()+"']").length?$("input.product-option[campaignproductid='"+$("#prod_id").val()+"']").trigger("mouseup"):""!=$("#prod_id").val()&&0==$("input.product-option[campaignproductid='"+$("#prod_id").val()+"']").length&&0!=$("input.product-option").length&&alert("ERROR: Campaign Product Id :"+$("#prod_id").val()+" is not assigned in this campaign")),0==$("#productOption-container input[type='radio'].product-selected").length&&testingDisplay(),form_obj.customCode()}function currentPage(){var e=window.location.pathname;return e.substring(e.lastIndexOf("/")+1).split(".")[0]}function getPages_shared_setup(){var e=getQueryStringByName("referrer");if("1"==getQueryStringByName("paypalAccept")){var t=sessionStorage.getItem("upsell_query");"/"==(e=getQueryStringValueByName("referrer",t))&&(e="")}return $.ajax({url:("/"==getQueryStringByName("referrer")?"":e)+"/shared_page_setup/setup.json",contentTypeString:"application/x-www-form-urlencoded",dataType:"json",async:!0})}function secondStepValidation(){getQueryStringByName("fields_keycode"),0==$("#cvv-link").length&&(error_msg+='- Please add an anchor tag id="cvv-link" with "(What\'s this?)" as the text content.\n\n'),"compact"==checkoutType&&(error_msg+=checkField("fields_address1","text",!0,!1),error_msg+=checkField("fields_city","text",!0,!1),error_msg+=checkField("fields_state","select",!0,!1),error_msg+=checkField("fields_zip","text",!1,!1),setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),addStatesProvince("#fields_state")),error_msg+=checkField("cc_type","select",!0,!1),error_msg+=checkField("cc_number","text",!1,!1),error_msg+=checkField("fields_expmonth","select",!0,!1),error_msg+=checkField("fields_expyear","select",!0,!1),error_msg+=checkField("cc_cvv","password",!0,!1),addPaymentOption("#cc_type"),0!=$("#chkboxSameAddress").length&&($("#chkboxSameAddress").prop("checked",!0),$("#billingAddress").hide()),""!=getQueryStringByName("fields_country")?FormSubmitValidation($.trim(getQueryStringByName("fields_country"))):0!=$(".fields_country").length&&FormSubmitValidation($.trim($("fields_country").val())),PreparePage()}function TriggerChange(e,t){$("#pay_source").val("creditcard"),0==$("#psmr-data").length&&form_obj.psmr_ok&&form_obj.psmr(),testingDisplay(),"CA"==$("#fields_country_select").val()?$("#fields_zip").attr({inputmode:"verbatim",pattern:"[A-Za-z0-9]*"}):$("#fields_zip").attr({inputmode:"numeric",pattern:"[0-9]*"}),$("#"+t).val($("#"+e).val())}function checkField(e,t,i,r){var a="";return $("#"+e).length>0?($("#"+e).is("select")?$("#"+e).attr("name",$("#"+e).attr("id")):($("#"+e).attr("type")!=t&&1==i&&$("#"+e).attr("type",t),$("#"+e).attr("id")!=$("#"+e).attr("name")&&"radio"!=t&&$("#"+e).attr("name",$("#"+e).attr("id")),$("#"+e).val()||1!=r||(a="- "+e+' [type="'+t+'"] should have a value.\n')),$("#"+e).removeAttr("required")):a="- "+e+' is missing.\n  Add it as type="'+t+'" with id="'+e+'" within the form element.\n\n',a}function shippingUpdateValidation(e){error_msg+=checkField("fields_fname","text",!0,!1),error_msg+=checkField("fields_lname","text",!0,!1),"compact"!=e&&(error_msg+=checkField("fields_address1","text",!0,!1),error_msg+=checkField("fields_city","text",!0,!1),error_msg+=checkField("fields_state","select",!0,!1),error_msg+=checkField("fields_zip","text",!1,!1),setInputDigit("#fields_zip"),setInputDigit("#fields_zip2")),PreparePage()}function firstStepValidation(e){error_msg+=checkField("fields_fname","text",!0,!1),error_msg+=checkField("fields_lname","text",!0,!1),"compact"!=e&&(error_msg+=checkField("fields_address1","text",!0,!1),error_msg+=checkField("fields_city","text",!0,!1),error_msg+=checkField("fields_state","select",!0,!1),error_msg+=checkField("fields_zip","text",!1,!1),setInputDigit("#fields_zip"),setInputDigit("#fields_zip2")),error_msg+=checkField("fields_phone","text",!1,!1),error_msg+=checkField("fields_email","text",!0,!1),$("#fields_fname").change((function(){TriggerChange("fields_fname","fields_fname2")})),$("#fields_fname2").change((function(){TriggerChange("fields_fname2","fields_fname")})),$("#fields_lname").change((function(){TriggerChange("fields_lname","fields_lname2")})),$("#fields_lname2").change((function(){TriggerChange("fields_lname2","fields_lname")})),$("#fields_address1").change((function(){TriggerChange("fields_address1","fields_address12")})),$("#fields_address12").change((function(){TriggerChange("fields_address12","fields_address1")})),$("#fields_address2").change((function(){TriggerChange("fields_address2","fields_address22")})),$("#fields_address22").change((function(){TriggerChange("fields_address22","fields_address2")})),$("#fields_city").change((function(){TriggerChange("fields_city","fields_city2")})),$("#fields_city2").change((function(){TriggerChange("fields_city2","fields_city")})),$("#fields_zip").change((function(){TriggerChange("fields_zip","fields_zip2")})),$("#fields_zip2").change((function(){TriggerChange("fields_zip2","fields_zip")})),$("#fields_phone").change((function(){TriggerChange("fields_phone","fields_phone2")})),$("#fields_phone2").change((function(){TriggerChange("fields_phone2","fields_phone")})),$("#fields_email").change((function(){TriggerChange("fields_email","fields_email2")})),$("#fields_email2").change((function(){TriggerChange("fields_email2","fields_email")})),$("#fields_state").change((function(){TriggerChange("fields_state","fields_state2")})),$("#fields_state2").change((function(){TriggerChange("fields_state2","fields_state")})),$("#fields_country_select").change((function(){TriggerChange("fields_country_select","fields_country_select2")})),$("#fields_country_select2").change((function(){TriggerChange("fields_country_select2","fields_country_select")})),PreparePage()}function unacceptedToTrial(e){return api.get_trial_pid()==$("#prod_id").val()&&-1!=api.get_restrict_trial_cc().toLowerCase().indexOf(e)&&(alert("Cards ("+api.get_restrict_trial_cc()+") are not supported for trial products!"),$("#cc_number").val(""),!0)}function checkCardType(e){if($("#cc_number").val()||$.isNumeric($("#cc_number").val())){var t=$("#cc_number").val().substr(0,1);if(t.length>0&&/^-?\d+$/.test(t))switch(parseInt(t)){case 4:result="visa",$(".visa").addClass("card-on"),$(".label-visa").addClass("blue"),$(".discover, .mastercard, .amex").removeClass("card-on"),$("#cc_type").val("visa"),$("#cc_cvv").attr("maxlength","3");break;case 5:result="mastercard",$(".mastercard").addClass("card-on"),$(".label-mastercard").addClass("blue"),$(".visa, .discover, .amex").removeClass("card-on"),$("#cc_type").val("mastercard"),$("#cc_cvv").attr("maxlength","3");break;case 6:result="discover",$(".discover").addClass("card-on"),$(".label-discover").addClass("blue"),$(".visa, .mastercard, .amex").removeClass("card-on"),$("#cc_type").val("discover"),$("#cc_cvv").attr("maxlength","3");break;case 3:result="amex",$(".amex").addClass("card-on"),$(".label-amex").addClass("blue"),$(".visa, .mastercard, .discover").removeClass("card-on"),$("#cc_type").val("amex"),$("#cc_cvv").attr("maxlength","4");break;case 0:case 7:result="visa",$("#cc_type").val("visa");break;default:$("#cc_type").val(""),$(".visa, .mastercard, .discover, .amex").removeClass("card-on"),$(".label-visa, .label-mastercard, .label-discover, .label-amex").removeClass("blue"),void 0!==e&&"keyup"==e.type&&alert("Only Visa, Mastercards, Discover and Amex are supported!"),$("#cc_number").val("")}unacceptedToTrial(result)}else $(".visa").removeClass("card-on"),$(".mastercard").removeClass("card-on"),$(".label-visa").removeClass("blue"),$(".label-mastercard").removeClass("blue")}function addPaymentOption(e){$(e).length>0&&($(e).empty(),$(e).append($("<option></option>").val("").html("Select")),$(e).append($("<option></option>").val("visa").html("VISA")),$(e).append($("<option></option>").val("mastercard").html("MASTERCARD")),$(e).append($("<option></option>").val("amex").html("AMEX")),$(e).append($("<option></option>").val("discover").html("DISCOVER")))}function PreparePage(){""!=error_msg&&alert("NOTE TO DEVELOPER/DESIGNER:\n\n"+error_msg),$("#cc_number").attr("maxlength","16"),$("#cc_cvv").attr("maxlength","4"),$("#cc_cvv").attr("autocomplete","off"),$("#cc_cvv").attr("autocorrect","off"),addYears("#fields_expyear",20),addMonths("#fields_expmonth"),setInputDigit("#cc_number"),setInputDigit("#cc_cvv"),$("#fields_expyear").bind("change",(function(){$("#fields_expmonth").valid()})),$("#fields_expmonth").bind("change",(function(){$("#fields_expyear").valid()})),$("#cc_number").bind("keyup change",(function(e){""!=$.trim($("#cc_number").val())?checkCardType(e):($("#cc_type").val(""),$(".visa, .mastercard, .amex, .discover").removeClass("card-on"),$(".label-visa, .label-mastercard, .label-amex, .label-discover").removeClass("blue")),$("#cc_type").trigger("click")})),$("#cc_type").change((function(){var e=$("#cc_number").val().substr(0,1);if(e.length>0&&/^-?\d+$/.test(e))switch(parseInt(e.substr(0,1))){case 4:$("#cc_type").val("visa");break;case 5:$("#cc_type").val("mastercard");break;case 6:$("#cc_type").val("discover");break;case 3:$("#cc_type").val("amex")}})),""!=$.trim($("#cc_number").val())&&checkCardType();var e="- Invalid phone number";$.validator.addMethod("phoneValidate",(function(t,i,r){var a=this.optional(i);if(""==$.trim(t))return!0;if(api.get_geoLookUp())return 0!=parseInt(t);switch(r.country){case"AU":case"NZ":case"PH":a=a||/^[0-9][0-9]+$/.test(t)||/^[1]+$/.test(t),e="- Invalid Phone Number - Phone number should not start with 0";break;case"GB":a=a||/^0[1-3578][0-9]+$/.test(t)||/^[1]+$/.test(t),e="- Invalid Phone Number - Did you forgot to add the leading zero?";break;case"FR":a=a||/^0[1-9][0-9]+$/.test(t)||/^[1]+$/.test(t),e="- Invalid Phone Number - Did you forgot to add the leading zero?";break;default:a=a||/^[2-9][0-9]+$/.test(t)||/^[1]+$/.test(t),e="- Invalid Phone Number - Phone number should not start with 1"}return a}),(function(){return e})),$.validator.addMethod("FnameValidate",(function(e,t){return this.optional(t)||e==e.match(/^[a-zA-Z\s]+$/)})),$.validator.addMethod("LnameValidate",(function(e,t){return this.optional(t)||e==e.match(/^[a-zA-Z\s]+$/)})),$.validator.addMethod("expirationYear",(function(e,t,i){var r="creditcard",a=!1;if($("#payment_options").length>0&&(r=$("#payment_options option:selected").val()),"creditcard"==r.toLowerCase()||"debitcard"==r.toLowerCase()){var n=(new Date).getFullYear();a=parseInt($("#"+i.year+" option:selected").text())>=n}else a=!0;return a}),"- Invalid card expiration year"),$.validator.addMethod("expirationMonth",(function(e,t,i){var r="creditcard",a=!1;if($("#payment_options").length>0&&(r=$("#payment_options option:selected").val()),"creditcard"==r.toLowerCase()||"debitcard"==r.toLowerCase()){var n=(new Date).getMonth()+1,o=(new Date).getFullYear(),s=-1;""!=$("#"+i.month).val()&&(s=parseInt($("#"+i.month).val()));var l=parseInt($("#"+i.year+" option:selected").text());a=l===o&&s>=n||l>o&&-1!=s}else a=!0;return a}),"- Invalid card expiration month"),$.validator.addMethod("validZipcode",(function(e,t,i){return("USA"!=i.country||-1!=$("#"+i.fields_zip).val().indexOf("-"))&&"AUS"!=i.country||!isNaN($("#"+i.fields_zip).val())}),"- Invalid zip code"),$.validator.addMethod("validateCreditCard",(function(e,t,i){var r="creditcard";return $("#payment_options").length>0&&(r=$("#payment_options option:selected").val()),"creditcard"!=r.toLowerCase()&&"debitcard"!=r.toLowerCase()||""!=e&&$.isNumeric($("#cc_number").val())&&$("#cc_number").val().length>=13&&$("#cc_number").val().length<=16}),"- Invalid card number"),$.validator.addMethod("validateCreditCardType",(function(e,t,i){var r="creditcard";return $("#payment_options").length>0&&(r=$("#payment_options option:selected").val()),"creditcard"!=r.toLowerCase()&&"debitcard"!=r.toLowerCase()||""!=e}),"- Invalid card number"),$.validator.addMethod("validateCreditCardCVV",(function(e,t,i){var r="creditcard";return $("#payment_options").length>0&&(r=$("#payment_options option:selected").val()),"creditcard"!=r.toLowerCase()&&"debitcard"!=r.toLowerCase()||""!=e&&$.isNumeric($("#cc_cvv").val())&&$("#cc_cvv").val().length<=4}),"- Invalid card cvv"),"undefined"!=typeof byPassExit&&(byPassExit=!1);var t=document.createElement("style"),i=".error { border:1px solid #b63333 !important; color: #b63333 !important;background-color:#ffdcdc !important;}.valid{ background-color: #dff5d9 !important;border: 1px solid #4fb633 !important; }.placeholder { color: #aaa; }select.form-control { transition: none; }";t.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i))}function handleBars_compile(e,t){var i=$("#"+e).html();return Handlebars.compile(i)(t)}window.extractDomain=function(e){var t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],$.trim(t)},window.getCurrentOffer=function(){var e=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")).toLowerCase().replace("/mobile",""),t=e.lastIndexOf("/");return(e=$.trim(e.substr(t).replace("/","")))==extractDomain(window.location.pathname)&&(e=""),"/"+e},window.addDays=function(e,t){var i=new Date(Number(e));return i.setDate(e.getDate()+t),i},window.getQueryStringValueByName=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},window.getQueryStringByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))},window.setInputDigit=function(e){$(e).unbind("keydown").keydown((function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110])||65==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}))},window.setInputLetters=function(e){$(e).unbind("input").on("input",(function(t){/^[A-Za-z]+$/.test($(e).val())||($(e).val($(e).val().replace(/[^a-zA-Z-\s]/g,"")),t.preventDefault())}))},window.removeQuerystring=function(e,t){var i=e.split("?");if(i.length>=2){for(var r=encodeURIComponent(t)+"=",a=i[1].split(/[&;]/g),n=a.length;n-- >0;)-1!==a[n].lastIndexOf(r,0)&&a.splice(n,1);return e=i[0]+"?"+a.join("&")}return e},window.findWithAttr=function(e,t,i){for(var r=0;r<e.length;r+=1)if(e[r][t]===i)return r;return-1},window.updateQueryStringParameter=function(e,t,i){var r=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return e.match(r)?e.replace(r,"$1"+t+"="+i+"$2"):e+a+t+"="+i},window.getProductOffers=function(e,t){var i=[];for(var r in e){var a=e[r];a.productType==t&&i.push(a)}return i},form_obj.firepixel=function(e){var t=e;t=updateQueryStringParameter(t,"adv_sub",getQueryStringByName("orderId")),t=updateQueryStringParameter(t,"adv_sub2",getQueryStringByName("transaction_id")),t=(t=(t=(t=updateQueryStringParameter(t,"transaction_id",getQueryStringByName("transaction_id"))).replace("{afid}",getQueryStringByName("afid"))).replace("{subid2}",getQueryStringByName("subid2"))).replace("{subid3}",getQueryStringByName("subid3")),$('<iframe id="pixel-frame" name="pixel-frame" frameBorder="0" style="width:1px;height:0px;border:none;"></iframe>').attr({src:t}).appendTo("body")},form_obj.test_psmr_api=function(){},form_obj.psmr=function(){if(0!=api.get_psmr_prod_id()&&"upsell"!=getQueryStringByName("fields_step")&&"thankyou"!=getQueryStringByName("fields_step")){var e=$('input.product-option[campaignproductid="'+api.get_psmr_prod_id()+'"]'),t=e.attr("productdescription"),i=api.get_psmr_status().toLowerCase(),r="opt-in"==i?"Opt In":"Opt Out";if(void 0===e.attr("campaignproductid"))return!1;function a(){0==$("#psmr-data").length&&$("<input>",{type:"hidden",class:"konnecktive-psmr-order",id:"psmr-data",value:e.attr("campaignproductid"),price:e.attr("price"),qty:e.attr("productqty"),shippingprice:e.attr("shipping-price"),productName:e.attr("product-name")}).insertAfter("#prod_id")}$("#psmr-container").html(r+"<input type='checkbox' id='opt' style='margin:0px 6px;'/>"+t),"opt-out"==i&&a(),$(document).on("click","#opt",(function(){switch(i){case"opt-in":$("#opt").is(":checked")?($(".psmr").show(),a()):($("input#psmr-data").remove(),$(".psmr").hide());break;case"opt-out":$("#opt").is(":checked")?($("input#psmr-data").remove(),$(".psmr").hide()):($(".psmr").show(),a())}form_obj.totalAmount()}))}},form_obj.disableBackHistory=function(){"object"==typeof window.history&&(window.history.pushState(null,null,window.location.href),window.onpopstate=function(e){e.preventDefault(),window.history.go(1)})},form_obj.PageEvent=function(e){switch(""!=getQueryStringByName("PayerID")&&""!=getQueryStringByName("paypalAccept")||api.importClick(),e){case"welcome":api.queryCampaign((function(e){if(req_response(e)){if(!form_obj.checkCampaignName(e.message.data[api.getCompaignId()].campaignName))return!1;currencySymbol=e.message.data[api.getCompaignId()].currencySymbol,"NORMAL"==api.getOfferType().toUpperCase()&&populateProductOffer(getProductOffers(e.message.data[api.getCompaignId()].products,"OFFER")),form_obj.hideProgress()}else alert("ERROR: "+e.message+".")}));break;case"first":form_obj.submitHandler(),api.queryCampaign((function(e){if(req_response(e)){if(!form_obj.checkCampaignName(e.message.data[api.getCompaignId()].campaignName))return!1;currencySymbol=e.message.data[api.getCompaignId()].currencySymbol,addCountries(e.message.data[api.getCompaignId()].countries),form_obj.listUpsells=getProductOffers(e.message.data[api.getCompaignId()].products,"UPSALE"),firstStepValidation(checkoutType),"one-page"==checkoutType&&(0==$("#cc_number").length&&(error_msg+="- This is a one-page checkout offer.  You should add customer credit card fields on this page."),secondStepValidation(),"NORMAL"==api.getOfferType().toUpperCase()&&populateProductOffer(getProductOffers(e.message.data[api.getCompaignId()].products,"OFFER"))),form_obj.hideProgress()}else alert("ERROR: "+e.message+".")}));break;case"second":form_obj.submitHandler(),api.queryCampaign((function(e){req_response(e)?(currencySymbol=e.message.data[api.getCompaignId()].currencySymbol,form_obj.listUpsells=getProductOffers(e.message.data[api.getCompaignId()].products,"UPSALE"),0==$("#cc_number").length&&(error_msg+="- This is a one-page checkout offer.  You should add customer credit card fields on this page."),secondStepValidation(),"NORMAL"==api.getOfferType().toUpperCase()&&populateProductOffer(getProductOffers(e.message.data[api.getCompaignId()].products,"OFFER"))):alert("ERROR: "+e.message+"."),form_obj.hideProgress()}));break;case"upsell":form_obj.disableBackHistory();var t,i=api.get_shared_page(),r=getQueryStringByName("referrer");if("1"==getQueryStringByName("paypalAccept")){var a=sessionStorage.getItem("upsell_query");i=getQueryStringValueByName("shared_page",a),api.setWithAds("true"===getQueryStringValueByName("wAds",a).toLowerCase()),api.setCompaignId(getQueryStringValueByName("campaignId",a)),api.set_corp_type(getQueryStringValueByName("corp_type",a)),t=api.queryCampaign2(),r=getQueryStringValueByName("referrer",a)}else t=api.queryCampaign2();""!=i?$.when(t,getPages_shared_setup()).done((function(e,t){$("#yes-upsell-relink, #no-upsell-relink, #prod_id").remove();var a=currentPage(),n="",o="",s="",l=-1!=i.indexOf("/")?i.substring(i.lastIndexOf("/"),-1)+"/":"";if(void 0!==t[0][a]){var d=t[0][a];d.hasOwnProperty("yes")?o=d.hasOwnProperty("yes_link_referrer_path")&&d.yes_link_referrer_path?r+"/"+d.yes+".html":api.get_shared_page_path()+l+d.yes+".html":(error_msg+="- yes property is undefined  \n"),d.hasOwnProperty("no")?s=d.hasOwnProperty("no_link_referrer_path")&&d.no_link_referrer_path?r+"/"+d.no+".html":api.get_shared_page_path()+l+d.no+".html":(error_msg+="- no property is undefined  \n"),d.hasOwnProperty("prod_id")?n=d.prod_id:(error_msg+="- prod_id property is undefined  \n"),$("body").append("<input type='hidden' id='yes-upsell-relink' value='"+o+"'/><input type='hidden' id='no-upsell-relink' value='"+s+"'/><input type='hidden' id='prod_id' value='"+n+"'/>"),$("a[href='/'],a[href='/index.html'], a[href='/default.html']").each((function(){$(this).attr("href",r)}))}else error_msg+="- "+a+" doesn't exists";if(""==error_msg){!function t(){0!=$("#prod_id").length?form_obj.upsellPageCallback(e[0]):setTimeout(t,300)}()}else error_msg="Please check shared page setup for "+a+"\n"+error_msg,alertError()})).fail((function(e){alert("ERROR: Something wrong! Please contact developer.")})):api.queryCampaign(form_obj.upsellPageCallback);break;case"thankyou":form_obj.disableBackHistory(),""!=getQueryStringByName("referrer")&&$("a[href='/'],a[href='/index.html'], a[href='/default.html']").each((function(){$(this).attr("href",getQueryStringByName("referrer"))})),api.queryOrder({},form_obj.thankyouPage);break;default:window.location.href="index.html"}};var label={},frmAlert={};function FormSubmitValidation(e,t){if($.fn.mask){var i,r,a,n;switch(setInputDigit("#fields_phone"),setInputDigit("#fields_phone2"),setInputDigit("#fields_phone_bill"),label.state="State",label.firstname="First Name",label.lastname="Last Name",label.city="City",label.zip="Zip Code",label.address="Address",label.phone="Phone",label.email="Email",frmAlert.FnameValidate="- First name should be letters only",frmAlert.LnameValidate="- Last name should be letters only",frmAlert.phonemin="- Phone number must consist of at least {0} digits",frmAlert.phonemax="- Phone number should not be more than {0} digits",frmAlert.email="- Invalid email",e.toUpperCase()){case"AU":case"ZA":i=9,n=12,r=4,a=4,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"CA":i=10,api.get_geoLookUp()&&(n=12,$("#fields_phone").mask("AAA AAA AAAA")),r=7,a=7,label.state="Province",label.zip="Postal code",setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),$("#fields_zip, #fields_zip2, #fields_zip_bill").mask("AAA AAA"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"GB":i=8,n=15,r=6,a=10,label.state="County",label.zip="Zip code",setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"FR":i=10,n=12,r=5,a=5,label.state="Ville",label.zip="Code postal",label.firstname="Prénom",label.lastname="Nom",label.address="Adresse",label.phone="Téléphone",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" Doit comporter au moins "+r+" caractères",frmAlert.zipmax="- "+label.zip+" Ne doit pas comporter plus de "+a+" caractères",frmAlert.phonemin="- Le numéro de téléphone doit comporter au moins {0} chiffres",frmAlert.phonemax="- Le numéro de téléphone ne doit pas dépasser {0} chiffres",frmAlert.FnameValidate="- "+label.firstname+" Ne doivent être que des lettres",frmAlert.LnameValidate="- "+label.lastname+" Ne doivent être que des lettres",frmAlert.email="- Invalide "+label.email;break;case"PH":i=10,n=11,r=4,a=4,label.state="Province",label.zip="Postal code",setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" digits",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" digits";break;case"SG":i=8,n=12,r=6,a=6,label.state="Region",label.zip="Postal code",setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" digits",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" digits";break;case"IE":i=9,n=12,r=5,a=8,label.state="State",label.zip="Postal code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"NZ":i=7,n=12,r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"ES":i=8,n=12,r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"CL":i=9,n=12,r=5,a=7,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"CO":i=8,n=12,r=5,a=6,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"MX":i=9,n=10,api.get_geoLookUp()&&(n=12,$("#fields_phone").mask("AA AAAA AAAA")),r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"PE":i=9,n=12,r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"CR":i=8,n=12,api.get_geoLookUp()&&(n=12,$("#fields_phone").mask("AAAA AAAA")),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask();break;case"SE":i=8,n=12,r=5,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"HU":i=8,n=12,r=4,a=4,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"AT":r=4,a=4,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"DK":case"BE":case"NO":i=8,n=12,r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"NL":i=8,n=12,r=4,a=6,label.state="State",label.zip="Zip code",setTimeout((function(){$("#fields_zip, #fields_zip2, #fields_zip_bill").unbind("keydown")}),300),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"PT":i=8,n=12,r=4,a=7,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;case"CH":r=4,a=5,label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),setInputDigit("#fields_zip_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters";break;default:i=10,n=10,api.get_geoLookUp()&&(n=12,$("#fields_phone").mask("AAA AAA AAAA")),$("#fields_zip, #fields_zip2, #fields_zip_bill").unmask(),r=5,a=5,0!=$("#fields_zip_bill").length&&($("#fields_zip_bill").val().indexOf("-")>-1?(a=10,ExpEntrZip_Key("#fields_zip_bill")):setInputDigit("#fields_zip_bill")),label.state="State",label.zip="Zip code",setInputDigit("#fields_zip"),setInputDigit("#fields_zip2"),frmAlert.zipmin="- "+label.zip+" must consist at least "+r+" characters",frmAlert.zipmax="- "+label.zip+" must consist no more than "+a+" characters"}setInputLetters("#fields_fname"),setInputLetters("#fields_fname2"),setInputLetters("#fields_lname"),setInputLetters("#fields_lname2"),setInputLetters("#fields_city"),setInputLetters("#fields_city2"),setInputLetters("#fields_fname_bill"),setInputLetters("#fields_lname_bill"),setInputLetters("#fields_city_bill"),$("#fields_zip, #fields_zip2, #fields_zip_bill").attr("minlength",r),$("#fields_zip, #fields_zip2, #fields_zip_bill").attr("maxlength",a);var o={fields_fname:{required:!0,FnameValidate:"fields_fname"},fields_lname:{required:!0,LnameValidate:"fields_lname"},fields_address1:"required",fields_city:"required",fields_country_select:"required",fields_state:"required",fields_zip:{required:!0,minlength:r,maxlength:a,validZipcode:{fields_zip:"fields_zip",country:e}},fields_email:{required:!0,pattern:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?\s*$/i},payment_options:"required",fields_agree:"required",cc_type:{validateCreditCardType:{card:"cc_type"}},product_option:{required:!0},field_product_installment:{validateProductInstallmentOption:{required:!0}},cc_number:{validateCreditCard:{card:"cc_number"}},fields_expyear:{expirationYear:{month:"fields_expmonth",year:"fields_expyear"}},fields_expmonth:{expirationMonth:{month:"fields_expmonth",year:"fields_expyear"}},cc_cvv:{validateCreditCardCVV:{card:"cc_cvv"}}},s={expiration:"fields_expmonth fields_expyear"},l={fields_fname:{required:"- "+label.firstname,FnameValidate:frmAlert.FnameValidate},fields_lname:{required:"- "+label.lastname,LnameValidate:frmAlert.LnameValidate},fields_address1:"- "+label.address,fields_country_select:"- Country",fields_city:"- "+label.city,fields_zip:{required:"- "+label.zip,minlength:frmAlert.zipmin,maxlength:frmAlert.zipmax},fields_email:{required:"- "+label.email,pattern:frmAlert.email},fields_state:"- "+label.state,cc_type:"- Credit card type",product_option:{required:"- Choose a product option"},cc_cvv:{required:"- CVV",digits:"- Invalid CVV"},fields_agree:"- Agree to our terms",payment_options:"- Payment options"};if(api.get_geoLookUp()?o.fields_phone={required:!0,phoneValidate:{fields_phone:"fields_phone",country:e}}:($("#fields_phone, #fields_phone2, #fields_phone_bill").attr("minlength",i),$("#fields_phone, #fields_phone2, #fields_phone_bill").attr("maxlength",n),l.fields_phone={required:"- "+label.phone,minlength:$.validator.format(frmAlert.phonemin),maxlength:$.validator.format(frmAlert.phonemax)},o.fields_phone={required:!0,digits:!0,minlength:i,maxlength:n,phoneValidate:{fields_phone:"fields_phone",country:e}}),$("#fields_phone").length>0&&$("#fields_phone").val().length>n&&$("#fields_phone").val($("#fields_phone").val().substr(0,n)),0!=$("#chkboxSameAddress").length){var d={fields_fname_bill:{required:"- Billing "+label.firstname,FnameValidate:frmAlert.FnameValidate},fields_lname_bill:{required:"- Billing "+label.lastname,LnameValidate:frmAlert.LnameValidate},fields_phone_bill:{required:"- Billing "+label.phone,minlength:$.validator.format(frmAlert.phonemin),maxlength:$.validator.format(frmAlert.phonemax)},fields_address1_bill:"- Billing "+label.address,fields_city_bill:"- Billing "+label.city,fields_zip_bill:{required:"- Billing "+label.zip,minlength:frmAlert.zipmin,maxlength:frmAlert.zipmax},fields_email_bill:{required:"- Billing "+label.email,email:frmAlert.email,pattern:frmAlert.email},fields_state_bill:"- Billing "+label.state},p={fields_fname_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}},FnameValidate:"fields_fname_bill"},fields_lname_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}},LnameValidate:"fields_lname_bill"},fields_phone_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}},digits:!0,minlength:i,maxlength:n,phoneValidate:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")},fields_phone:"fields_phone_bill",country:e}},fields_address1_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}}},fields_city_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}}},fields_state_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}}},fields_zip_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}},minlength:r,maxlength:a,validZipcode:{fields_zip:"fields_zip_bill",country:e}},fields_email_bill:{required:{depends:function(e){return!$("#chkboxSameAddress").is(":checked")}},pattern:/^ [-a - z0 - 9~!$ %^&* _=+}{ \'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?\s*$/i}};$.extend(o,p),$.extend(l,d)}if(void 0!==t&&1==t){var c=$("form").validate();c.resetForm(),c.settings.rules=o,c.settings.messages=l,c.settings.groups=s}else $("form").validate({rules:o,messages:l,groups:s})}else setTimeout((function(){FormSubmitValidation(e,t)}),100)}function req_response(e){return"success"==e.result.toLowerCase()||(wasSubmitted=!1,form_obj.hideProgress(),!1)}function isNullOrEmpty(e){return""==e||"null"==e||null==e?"":e}function alertError(){""!=error_msg&&alert(error_msg)}function konnektiveOrderValid(){var e=0;return $("input[type='hidden'].konnecktive-order").each((function(){void 0===$(this).attr("price")&&e++})),0==e}function couponCodeEvent(){var e=document.createElement("style");e.innerText="div#wave{display:inline;text-align:center;width:30px;height:10px}div#wave .dot{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:7px;background:#fbfbfb;animation:1.3s linear infinite wave;position:relative;opacity:.9}div#wave .dot:nth-child(2){animation-delay:-1.1s}div#wave .dot:nth-child(3){animation-delay:-.9s}@keyframes wave{0%,100%,60%{transform:initial}30%{transform:translateY(-6px)}}".toString(),document.head.appendChild(e),$("#fields_coupon").unbind().on("keypress",(function(e){if(e.stopPropagation(),13==(e.keyCode||e.which))return e.preventDefault(),$("#btnCoupon").trigger("click"),!1})),$("#btnCoupon").unbind().on("click",(function(e){e.stopPropagation(),$(this).html('<div id="wave"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>');var t=$("#fields_coupon").val();return""!=t?api.orderCoupon(t,$("#prod_id").val(),form_obj.orderCoupon,$("#prod_id").attr("qty")):(alert("Please enter coupon code"),$(this).text("Apply Coupon")),!1}))}function hasQueryURL(){var e=location.search;return-1!=e.indexOf("?")&&e.length>1}function additionalQuery(){var e="";return 0!=api.get_paypal_forceMerchantId()&&""==getQueryStringByName("paypal_forceMerchantId")&&(e+="&paypal_forceMerchantId="+api.get_paypal_forceMerchantId()),0!=api.get_warranty_prod_id()&&""==getQueryStringByName("warranty_prod_id")&&(e+="&warranty_prod_id="+api.get_warranty_prod_id()),0!=api.get_psmr_prod_id()&&""==getQueryStringByName("psmr_prod_id")&&(e+="&psmr_prod_id="+api.get_psmr_prod_id()+"&psmr_status="+api.get_psmr_status()+"&psmrToBoss="+api.get_psmrToBoss()+"&psmrBoss_key="+api.get_psmrBoss_key()+"&psrm_keycode="+api.get_psrm_keycode()),0!=api.get_trial_pid()&&(e+="&trial_pid="+api.get_trial_pid()+"&r_trial_cc="+api.get_restrict_trial_cc()),0!=api.get_ss_id()&&""==getQueryStringByName("ss_id")&&(e+="&ss_id="+api.get_ss_id()+"&ss_onSuccess="+api.get_ss_onSuccess()),""!=api.get_pixel()&&(e+="&pixel="+api.get_pixel()),""!=api.get_shared_page()&&(e+="&shared_page="+api.get_shared_page()),""!=billerNameDomain&&(e+="&billerNdomain="+billerNameDomain),api.get_geoLookUp()&&(e+="&geoLookUp="+api.get_geoLookUp()),api.getWithAds()&&(e+="&wAds="+api.getWithAds()),null!=api.get_affiliate_id()&&(e+="&d_aff_id="+api.get_affiliate_id()),""!=api.get_affiliate_source1()&&(e+="&aff_s1="+api.get_affiliate_source1()),""!=api.get_affiliate_source2()&&(e+="&aff_s2="+api.get_affiliate_source2()),""!=api.get_affiliate_source3()&&(e+="&aff_s3="+api.get_affiliate_source3()),""!=api.get_affiliate_source4()&&(e+="&aff_s4="+api.get_affiliate_source4()),""!=api.get_affiliate_source5()&&(e+="&aff_s5="+api.get_affiliate_source5()),""!=api.get_corp_type()&&(e+="&corp_type="+api.get_corp_type()),e}function checkDefinedIds(){var e=0;(error_msg="Product id(s) not exist in the campaign. Please fix the following: \n\n",0!=api.get_warranty_prod_id())&&(void 0===$('input.product-option[campaignproductid="'+api.get_warranty_prod_id()+'"]').attr("campaignproductid")&&(error_msg+="- warranty product id (warranty_prod_id) \n",e++));0!=api.get_psmr_prod_id()&&(void 0===$('input.product-option[campaignproductid="'+api.get_psmr_prod_id()+'"]').attr("campaignproductid")&&(error_msg+="- psmr product id (psmr_prod_id) \n",e++));0!=api.get_trial_pid()&&(void 0===$('input.product-option[campaignproductid="'+api.get_trial_pid()+'"]').attr("campaignproductid")&&(error_msg+="- trial product id (trial_pid) \n",e++));0!=api.get_ss_id()&&(void 0===$('input.product-option[campaignproductid="'+api.get_ss_id()+'"]').attr("campaignproductid")&&(error_msg+="- straight sale product id (ss_id) \n",e++));return 0!=e?(alertError(),error_msg="",!0):(error_msg="",!1)}function checkCampaignID(){return-1!=api.getCompaignId()||(alert("Missing Campaign id!"),!1)}function upsell_no(e){if(""!=getQueryStringByName("PayerID")||""!=getQueryStringByName("paypalAccept")){var t=sessionStorage.getItem("upsell_query"),i=getQueryStringValueByName("upsell_no",t),r=getQueryStringValueByName("fields_step",t);if(""==i&&"upsell"==r)e=updateQueryStringParameter(e,"upsell_no",2);else if(""!=i&&"upsell"==r){var a=parseInt(i);e=updateQueryStringParameter(e,"upsell_no",1+a)}else e=removeQuerystring(e,"upsell_no")}else if(""==getQueryStringByName("upsell_no")&&"upsell"==getQueryStringByName("fields_step"))e=updateQueryStringParameter(e,"upsell_no",2);else if(""!=getQueryStringByName("upsell_no")&&"upsell"==getQueryStringByName("fields_step")){a=parseInt(getQueryStringByName("upsell_no"));e=updateQueryStringParameter(e,"upsell_no",1+a)}else e=removeQuerystring(e,"upsell_no");return e}return form_obj.checkSubdomain=function(e){return e.length>3||3==e.length&&-1==e.indexOf("shop")&&-1==e.indexOf("shopdev")?(e.shift(),e=e.join(".")):e=e.join(".")},form_obj.checkCampaignName=function(e){e=form_obj.checkSubdomain(e.split("."));var t=form_obj.checkSubdomain($("#website").val().split(".")),i=form_obj.checkSubdomain(location.hostname.split(".")),r=-1==e.indexOf("/")&&-1==e.indexOf(".")?getCurrentOffer().replace("/",""):getCurrentOffer(),a="Campaign name setup mismatched:\n\n#website element: "+(-1==e.indexOf("/")&&-1==e.indexOf(".")?r:t+r)+"\nKonnektive Setup: "+e.trim()+"\n\nPlease check <input id='website'/> element value. It should be "+e;return"/"==getCurrentOffer()&&(r=""),-1!=location.hostname.toLowerCase().indexOf("shopdev.")?i=i.toLowerCase().replace("shopdev.","shop."):-1!=location.hostname.toLowerCase().indexOf("dev.")?i=i.toLowerCase().replace("dev.",""):-1!=location.hostname.toLowerCase().indexOf("www.")&&(i=i.toLowerCase().replace("www.","")),console.log(i+r),console.log(t+r),0==$("#website").length?(alert("Please add <input id='website'/> element with a value of the domain name."),!1):-1==e.indexOf("/")&&r!=e.trim()&&-1==e.indexOf(".")?(alert(a),!1):-1==e.indexOf("/")&&r==e.trim()&&-1==e.indexOf(".")?(billerNameDomain=""==location.port?i:t,!0):t+r!=e.trim()?(alert(a),!1):i+r==e.trim()||""!=location.port||(alert(a),!1)},form_obj.customCode=function(e){},form_obj.totalAmount=function(){var e=0;$("input[type='hidden'].konnecktive-order").each((function(){e+=parseFloat($(this).attr("price"))*parseInt($(this).attr("qty"))+parseFloat($(this).attr("shippingprice"))*parseInt($(this).attr("qty"))})),0!=$("#totalDiscount_applied").length&&(e-=parseFloat($("#totalDiscount_applied").val())),$(".main-total").html(currencySymbol+e.toFixed(2)),$(".main-total2").html(e.toFixed(2)),testingDisplay()},form_obj.orderCoupon=function(e){if(req_response(e)){if(0==e.message.priceDiscount&&0==e.message.shipDiscount)return alert("Invalid Coupon Code"),$("#btnCoupon").html("Apply Coupon"),!1;var t=e.message.priceDiscount,i=e.message.shipDiscount,r=t+i;$(".totalDiscount").html(currencySymbol+r.toFixed(2)),$(".totalDiscount2").html(r.toFixed(2)),$(".discount-container").show(),$("body").append("<input type='hidden' id='totalDiscount_applied' value='"+r+"'/>"),$(".dicountedPrice, [campaignproductid='"+$("#prod_id").val()+"'] .dicountedPrice").html(currencySymbol+t),$(".dicountedShipping, [campaignproductid='"+$("#prod_id").val()+"'] .dicountedShipping").html(currencySymbol+i),$(".dicountedPrice2, [campaignproductid='"+$("#prod_id").val()+"'] .dicountedPrice2").html(t),$(".dicountedShipping2, [campaignproductid='"+$("#prod_id").val()+"'] .dicountedShipping2").html(i),0==$(".congrats-wrapper-priority").length?0==$(".congrats-wrapper").length?$(".coupon-wrapper").before('<div class="congrats-wrapper" data-promo-product-price="'+parseFloat(e.message.priceDiscount).toFixed(2)+'" data-promo-shipping-price="'+parseFloat(e.message.shipDiscount).toFixed(2)+'"><span style="font-size:16px; font-weight:bold;color:#94C120;">CONGRATULATIONS! Discount Applied.</span><div>'):($(".congrats-wrapper").attr("data-promo-product-price",parseFloat(e.message.priceDiscount).toFixed(2)),$(".congrats-wrapper").attr("data-promo-shipping-price",parseFloat(e.message.shipDiscount).toFixed(2)),$(".congrats-wrapper").fadeIn()):($(".congrats-wrapper-priority").attr("data-promo-product-price",parseFloat(e.message.priceDiscount).toFixed(2)),$(".congrats-wrapper-priority").attr("data-promo-shipping-price",parseFloat(e.message.shipDiscount).toFixed(2)),$(".congrats-wrapper-priority").fadeIn()),coupon_code=$("#fields_coupon").val(),$.cookie("CouponCode",$("#fields_coupon").val()),$.cookie("ProductOptionID",$("#prod_id").val()),$(".coupon-wrapper").hide(),form_obj.totalAmount(),$("#btnCoupon").html("Apply Coupon")}else alert(e.message)},form_obj.upsell_number=function(e){return upsell_no(e)},form_obj.cleanQueryURL=function(e){var t=location.search;if(t=removeQuerystring(t,"descriptor"),t=removeQuerystring(t,"desc_individual"),t=removeQuerystring(t,"fields_step"),t=removeQuerystring(t,"confirm_upsell"),t=removeQuerystring(t,"from_page"),("second"==getQueryStringByName("fields_step")||""==getQueryStringByName("fields_step")&&0!=$("#cc_number").length)&&(t=removeQuerystring(t,"warranty_prod_id"),t=removeQuerystring(t,"psmr_prod_id"),t=removeQuerystring(t,"psmr_status"),t=removeQuerystring(t,"psmrToBoss"),t=removeQuerystring(t,"psmrBoss_key"),t=removeQuerystring(t,"psrm_keycode"),t=removeQuerystring(t,"geoLookUp")),t=removeQuerystring(t,"paypalAccept"),t=removeQuerystring(t,"token"),t=removeQuerystring(t,"ba_token"),t=removeQuerystring(t,"PayerID"),t=updateQueryStringParameter(t,"wAds",api.getWithAds()),void 0!==e.message.paySource){if("paypal"==e.message.paySource.toLowerCase()){var i=[];i.push(JSON.parse(sessionStorage.getItem("paypalExpress")));var r="?"+i[0].salesUrl.split("?")[1];r=removeQuerystring(r,"descriptor"),r=removeQuerystring(r,"desc_individual"),r=removeQuerystring(r,"fields_step"),r=removeQuerystring(r,"warranty_prod_id"),r=removeQuerystring(r,"psmr_prod_id"),r=removeQuerystring(r,"psmr_status"),r=removeQuerystring(r,"confirm_upsell"),r=removeQuerystring(r,"from_page"),-1==(r=updateQueryStringParameter(r,"campaignId",e.message.campaignId)).toLowerCase().indexOf("checkouttype")&&(r=updateQueryStringParameter(r,"checkoutType",api.getCheckoutType())),-1==r.toLowerCase().indexOf("offertype")&&(r=updateQueryStringParameter(r,"offerType",api.getOfferType().toLowerCase())),""!=api.get_pixel()&&(r=updateQueryStringParameter(r,"pixel",api.get_pixel())),api.getWithAds()&&(r=updateQueryStringParameter(r,"wAds",api.getWithAds())),r=updateQueryStringParameter(r,"orderId",e.message.orderId),r=updateQueryStringParameter(r,"PayerID",getQueryStringByName("PayerID")),r=updateQueryStringParameter(r,"country",e.message.country),r=updateQueryStringParameter(r,"corp_type",api.get_corp_type()),0!=api.get_paypal_forceMerchantId()&&(r=updateQueryStringParameter(r,"paypal_forceMerchantId",api.get_paypal_forceMerchantId())),t=r}else t=updateQueryStringParameter(t,"orderId",e.message.orderId),t=updateQueryStringParameter(t,"checkoutType",api.getCheckoutType()),t=updateQueryStringParameter(t,"offerType",api.getOfferType().toLowerCase()),t=updateQueryStringParameter(t,"campaignId",e.message.campaignId),t=updateQueryStringParameter(t,"paypal_forceMerchantId",api.get_paypal_forceMerchantId()),t=updateQueryStringParameter(t,"country",e.message.country),t=updateQueryStringParameter(t,"corp_type",api.get_corp_type()),""!=api.get_pixel()&&(t=updateQueryStringParameter(t,"pixel",api.get_pixel()));t=updateQueryStringParameter(t,"paysource",e.message.paySource.toLowerCase()),""!=api.get_shared_page()&&(t=updateQueryStringParameter(t,"shared_page",api.get_shared_page()),""==getQueryStringByName("referrer")&&(t=updateQueryStringParameter(t,"referrer",getCurrentOffer())))}-1!=(t=upsell_no(t)).indexOf("?")&&t.length>1&&(t="&"+t.substring(1));var a=[],n=[],o=getQueryStringByName("descriptor");if(""!=o&&(a=o.split(",")),void 0!==e)for(var s in e.message.items){var l=e.message.items[s];for(var d in l)"descriptor"==d&&(-1==a.indexOf(l[d])&&a.push(l[d]),n.push(l[d]))}return{params:t,order_items:a,descriptor_individual:n}},form_obj.checkUpsellProdId=function(e){if(-1==findWithAttr(form_obj.listUpsells,"campaignProductId",parseInt(e))){error_msg+="The following are product upsale ids that are only available in this campaign. \nAdd the product id directly in the <input id='prod_id'/> as value.\n\n";var t=getQueryStringByName("billerNdomain");for(var i in form_obj.listUpsells)""!=t&&-1==form_obj.listUpsells[i].billerName.toLowerCase().indexOf(t.toLowerCase())||(error_msg+="- Product id: "+form_obj.listUpsells[i].campaignProductId+" - "+form_obj.listUpsells[i].productName+" ("+form_obj.listUpsells[i].billingCycleType+")\n\n");return error_msg+="Example: <input type='hidden' id='prod_id' value='22'/>\n",error_msg+="-------------------------------------------------------\n\n",error_msg+="Your current value of prod_id is "+e+"\n\n",!1}return!0},form_obj.checkYesUpsell=function(){var e=$("#yes-upsell-relink").val().trim().toLowerCase().split("/").pop(),t=[],i=getQueryStringByName("confirm_upsell");return""!=i?(-1!=i.indexOf(",")?t=i.split(","):t.push(i),-1==t.indexOf(e)&&t.push(e)):t.push(e),t.toString()},form_obj.upsellClick_response=function(e){var t=window.location.pathname,i=t.substring(t.lastIndexOf("/")+1);if(req_response(e)){var r=form_obj.cleanQueryURL(e);-1!=$("#yes-upsell-relink").val().trim().toLowerCase().indexOf("thankyou.html")?window.location.href=$("#yes-upsell-relink").val().trim()+"?fields_step=thankyou"+removeQuerystring(r.params,"upsell_no")+"&descriptor="+encodeURIComponent(r.order_items.toString())+"&desc_individual="+encodeURIComponent(r.descriptor_individual.toString())+"&confirm_upsell="+form_obj.checkYesUpsell()+"&from_page="+i:window.location.href=$("#yes-upsell-relink").val().trim()+"?fields_step=upsell"+r.params+"&descriptor="+encodeURIComponent(r.order_items.toString())+"&desc_individual="+encodeURIComponent(r.descriptor_individual.toString())+"&confirm_upsell="+form_obj.checkYesUpsell()+"&from_page="+i}else if(-1!=e.message.toLowerCase().indexOf("already taken")||-1!=e.message.toLowerCase().indexOf("captured")){alert(e.message+" Redirecting to the next page...");r=form_obj.cleanQueryURL(e);var a=sessionStorage.getItem("upsell_query");""!=getQueryStringByName("PayerID")?-1!=$("#yes-upsell-relink").val().trim().toLowerCase().indexOf("thankyou.html")?(a=removeQuerystring(a,"fields_step"),a=removeQuerystring(a,"upsell_no"),window.location.href=$("#yes-upsell-relink").val().trim()+"?fields_step=thankyou&"+a.substring(1)):window.location.href=$("#yes-upsell-relink").val().trim()+upsell_no(a):-1==$("#yes-upsell-relink").val().trim().toLowerCase().indexOf("thankyou.html")?window.location.href=$("#yes-upsell-relink").val().trim()+upsell_no(location.search):window.location.href=$("#yes-upsell-relink").val().trim()+updateQueryStringParameter(removeQuerystring(location.search,"upsell_no"),"fields_step","thankyou")}else alert("ERROR: "+e.message+".")},form_obj.upsellPageCallback=function(e){if(form_obj.hideProgress(),req_response(e)){if(currencySymbol=e.message.data[api.getCompaignId()].currencySymbol,populateProductOffer(getProductOffers(e.message.data[api.getCompaignId()].products,"UPSALE")),form_obj.listUpsells=getProductOffers(e.message.data[api.getCompaignId()].products,"UPSALE"),"1"==getQueryStringByName("paypalAccept")){var t=[];return t.push(JSON.parse(sessionStorage.getItem("paypalExpress"))),t[0].token=getQueryStringByName("token"),t[0].payerId=getQueryStringByName("PayerID"),t[0].paypalAccept=getQueryStringByName("paypalAccept"),form_obj.showProgress(),console.log("show progress"),api.importUpsell(t,"",form_obj.upsellClick_response),!1}if(0==$("#yes-upsell-relink").length&&(error_msg+='Add #yes-upsell-relink with a redirection path as value.\n Example:\n\n<input type="hidden" id="yes-upsell-relink" value="upsell2.html"/>\n\n'),0==$("#no-upsell-relink").length&&(error_msg+='Add #no-upsell-relink with a redirection path as value.\n Example:\n\n<input type="hidden" id="no-upsell-relink" value="downsell.html"/>\n\n'),0==$(".yes-upsell-link").length&&(error_msg+='Add .yes-upsell-link to an element.\n Example:\n\n<span class="yes-upsell-link> Yes, Add it to my order.</span>\n\n'),0==$(".no-upsell-link").length&&(error_msg+='Add .no-upsell-link to a link element.\n Example:\n\n<a href="upsell1.html" class="no-upsell-link> No thanks</span>\n\n'),""!=error_msg)alertError();else if(0!=$("#prod_id").length){if(form_obj.checkUpsellProdId($("#prod_id").val())){if($(".no-upsell-link").unbind().on("click",(function(e){e.preventDefault(),form_obj.showProgress();var t=$("#no-upsell-relink").val().trim();return-1!=t.toLowerCase().indexOf("thankyou.html")?window.location.href=t.trim()+updateQueryStringParameter(removeQuerystring(location.search,"upsell_no"),"fields_step","thankyou"):window.location.href=t.trim()+upsell_no(location.search),!1})),"paypal"==getQueryStringByName("paysource").toLowerCase())return form_obj.upsellCustomCode(),!1;$(".yes-upsell-link, #yes-upsell-link").unbind().on("click",(function(e){if(e.preventDefault(),form_obj.showProgress(),""==$("#prod_id").val()||void 0===$("#prod_id").attr("price"))return form_obj.hideProgress(),alert("ERROR: Missing Campaign Id"),!1;api.importUpsell([{productQty:$("#prod_id").attr("qty")}],$("#prod_id").val().trim(),(function(e){form_obj.upsellClick_response(e)}))}))}alertError()}else alert("Please add <input type='hidden' id='prod_id'/>");form_obj.upsellCustomCode()}else alert("ERROR: "+e.message+".")},form_obj.upsellCustomCode=function(){},form_obj.hideProgress=function(){function e(){$("#progress-dialog").trigger("closeModal")}if(""!=getQueryStringByName("transaction_id")&&"upsell"==getQueryStringByName("fields_step")&&withPixel){!function t(){0!=$("#pixel-frame").length?$("#pixel-frame").on("load",(function(){e()})):setTimeout(t,100)}()}else e()},form_obj.showProgress=function(e){void 0===e&&(e="Processing your request...Please wait."),0==$("#progress-dialog").length?$('<div id="progress-dialog" style="opacity: 0.85;min-height:20px; min-width:250px;font-family:arial;background:#454545;color:#fff;border:2px solid #fff; padding:10px;border-radius:10px;font-size:12px;font-weight:bold;"><div id="progress-loading" style="margin-top: 1px;position: absolute;left:10px;"><img src="/onlineorder/images/loading.gif" alt="loading" width="16" height="16" /></div><div style="margin-left:25px;text-align:left;" id="progress-text">'+e+"</div></div>").appendTo("body"):$("#progress-text").text(e),$("#progress-dialog").easyModal({autoOpen:!0,overlayOpacity:.5,overlayColor:"#000",overlayClose:!1,closeOnEscape:!1,updateZIndexOnOpen:!1,zIndex:function(){return 9999999}})},form_obj.paypalCallback=function(e){"success"==e.result.toLowerCase()?e.message&&e.message.paypalUrl&&(window.location.href=e.message.paypalUrl):(alert(e.message),form_obj.hideProgress())},form_obj.choosePaypalProd=function(){if(testingDisplay(),form_obj.showProgress(),""!=getQueryStringByName("fields_step")&&"second"!=getQueryStringByName("fields_step"))if(""!=getQueryStringByName("PayerID")){var e={salesUrl:location.href,errorRedirectsTo:location.href,paySource:"PAYPAL",paypalBillerId:api.get_paypal_forceMerchantId(),orderId:getQueryStringByName("orderId"),productId:$("#prod_id").val().trim(),productQty:$("#prod_id").attr("qty")};sessionStorage.setItem("paypalExpress",JSON.stringify(e)),sessionStorage.setItem("redirection_paypal",location.href),sessionStorage.setItem("upsell_query",location.search),api.importUpsell([e],"",form_obj.paypalCallback)}else api.importUpsell([{paySource:"PAYPAL",forceMerchantId:getQueryStringByName("paypal_forceMerchantId"),productQty:$("#prod_id").attr("qty")}],$("#prod_id").val().trim(),form_obj.upsellClick_response);else api.importOrderPaypalExpress(form_obj.cartItems(),form_obj.paypalCallback)},form_obj.paypalTrigger=function(){if(0!=api.get_paypal_forceMerchantId()&&""!=api.get_paypal_forceMerchantId()){if("thankyou"==getQueryStringByName("fields_step"))return!1;0==$(".paypal-btn").length&&alert("Please add a button with assign class of .paypal-btn"),$(".paypal-btn").unbind().on("click",(function(e){e.preventDefault(),$("#psmr-data").remove(),$("#opt").prop("checked",!1),$("#pay_source").val("paypal"),form_obj.choosePaypalProd()}))}else 0!=$(".paypal-btn").length&&0==api.get_paypal_forceMerchantId()&&alert("You have paypal button assign to .paypal-btn but you don't have paypal_forceMerchantId value.")},form_obj.delivery_date=function(){$(".delivery-date").text(addDays(new Date,7).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))},form_obj.initilizeGeolookup=function(){form_obj.geoLookUp_();var e=document.querySelector("#fields_country_select");$("#fields_phone").on("countrychange",(function(e){var t=iti.getSelectedCountryData().iso2.toUpperCase();$("#fields_phone").val(""),$("#fields_country_select").val(),"MX"==t?($("#fields_phone").mask("AA AAAA AAAA"),$("#fields_phone").attr("maxlength",12)):"CR"==t?($("#fields_phone").mask("AAAA AAAA"),$("#fields_phone").attr("minlength",9)):($("#fields_phone").mask("AAA AAA AAAA"),$("#fields_phone").attr("maxlength",12))})),e.addEventListener("change",(function(){iti.setCountry(this.value.toLowerCase())}))},form_obj.wrapForm=function(){"upsell"!=getQueryStringByName("fields_step")&&"thankyou"!=getQueryStringByName("fields_step")&&($("form").contents().unwrap(),$("body").wrapInner("<form></form>"),$("form").attr("method","post"))},form_obj.initPage=function(){var e,t=$.cookie("pixel_setup"),i=$.cookie("pixel"),r=location.pathname.toLowerCase();if(form_obj.wrapForm(),$("input, select").removeAttr("required"),0==$("#modal-popup").length&&$("body").append('<div id="modal-popup"></div>'),$("input, select").removeClass("required"),$("#fields_zip, #cc_cvv, #fields_phone, #cc_number").attr({inputmode:"numeric",pattern:"[0-9]*"}),$("form").unbind().on("keypress",(function(e){if(13==(e.keyCode||e.which))return e.preventDefault(),$("form").submit(),!1})),form_obj.delivery_date(),couponCodeEvent(),form_obj.paypalTrigger(),line_loaderCss(),api.get_geoLookUp()&&0==api.get_geoLookUp_delay()&&form_obj.initilizeGeolookup(),-1==r.indexOf("upsell.html")||""==getQueryStringByName("afid")&&""==getQueryStringByName("affId")||null==i||"pix"!=getQueryStringByName("pixel")){if(null!=t&&(""!=getQueryStringByName("afid")||""!=getQueryStringByName("affId"))&&"pix_setup"==getQueryStringByName("pixel")){function a(e,t){void 0!==e?getQueryStringByName("from_page")==e+".html"&&(withPixel=!0,form_obj.hideProgress(),form_obj.firepixel(t)):(withPixel=!0,form_obj.hideProgress(),form_obj.firepixel(t))}$.removeCookie("pixel");try{var n=JSON.parse(t);if(0!=Object.keys(n).length){var o=findWithAttr(n,"page",r.split("/").pop());(-1!=o&&"upsell.html"==r.split("/").pop()||-1!=o&&-1!=getQueryStringByName("confirm_upsell").toLowerCase().indexOf(r.split("/").pop())||-1!=o&&""==getQueryStringByName("confirm_upsell"))&&a(n[o].from_page,n[o].pixel_path)}}catch(p){console.log(p)}}}else withPixel=!0,form_obj.hideProgress(),$.removeCookie("pixel_setup"),form_obj.firepixel(i);if(0!=$("#chkboxSameAddress").length){if($("#chkboxSameAddress").click((function(e){0==$(this).is(":checked")&&("second"==getQueryStringByName("fields_step")?($("#fields_address1_bill").val(getQueryStringByName("fields_address1")),""!=getQueryStringByName("fields_address2")&&$("#fields_address2_bill").val(getQueryStringByName("fields_address2")),$("#fields_city_bill").val(getQueryStringByName("fields_city")),$("#fields_state_bill").val(getQueryStringByName("fields_state")),$("#fields_zip_bill").val(getQueryStringByName("fields_zip"))):($("#fields_address1_bill").val($("#fields_address1").val()),""!=$("#fields_address2").val()&&$("#fields_address2_bill").val($("#fields_address2").val()),$("#fields_city_bill").val($("#fields_city").val()),$("#fields_state_bill").val($("#fields_state").val()),$("#fields_zip_bill").val($("#fields_zip").val()),$("#fields_zip_bill").rules("remove","validZipcode"),$("#fields_zip_bill").val().length>0&&$("#fields_zip_bill").val().indexOf("-")>0&&($("#fields_zip_bill").attr("maxlength",10),$("#fields_zip_bill").rules("add",{maxlength:10})))),$("#billingAddress").slideToggle()})),$(".billingAddress-input-format").length>0){var s=$(".billingAddress-input-format input").attr("class"),l=[{label:"First Name",input:"<input class='"+s+"' id='fields_fname_bill' name='fields_fname_bill' placeholder='First Name'/>"},{label:"Last Name",input:"<input class='"+s+"' id='fields_lname_bill' name='fields_lname_bill' placeholder='Last Name'/>"},{label:"Address 1",input:"<input class='"+s+"' id='fields_address1_bill' name='fields_address1_bill' placeholder='Address 1'/>"},{label:"Address 2",input:"<input class='"+s+"' id='fields_address2_bill' name='fields_address2_bill' placeholder='Address 2'/>"},{label:"State",input:"<select class='"+s+"' name='fields_state_bill' id='fields_state_bill'></select>"},{label:"City",input:"<input class='"+s+"' id='fields_city_bill' name='fields_city_bill' placeholder='City'/>"},{label:"Zip",input:"<input class='"+s+"' id='fields_zip_bill' name='fields_zip_bill' placeholder='Zip'/>"}];$(".billingAddress-input-format input").remove();var d=$(".billingAddress-input-format").html();$(".billingAddress-input-format").remove(),$.each(l,(function(e,t){var i=d.replace("{{label}}",t.label).replace("{{input}}",t.input);$("#billingAddress").append(i)})),addStatesProvince("#fields_state_bill")}PreFillForm()}$("input[id*='fields'], select").unbind("blur").blur((function(){function e(){if(api.get_geoLookUp()){var e=iti.getNumber();api.importLead(e)}else api.importLead()}"thankyou"!=getQueryStringByName("fields_step")&&(0!=$("#fields_phone").length&&""!=$("#fields_phone").val()?$("#fields_phone").valid()&&e():0!=$("#fields_phone").length&&""!=$("#fields_phone").val()||e())})),""==(e=$("#fields_step").length>0?$("#fields_step").val():getQueryStringByName("fields_step"))&&(e="first",0==$("#fields_step").length&&$("form:first").append('<input type="hidden" id="fields_step" name="fields_step" value="first"/>')),""!=error_msg?"first"!=e&&""!=e?alert("Page Invalid"):alert(error_msg):$("#is_intro").length>0&&"1"==$("#is_intro").val()?form_obj.PageEvent("welcome"):form_obj.PageEvent(e)},form_obj.getCouponCode=function(){return coupon_code},form_obj.setCouponCode=function(e){coupon_code=e},form_obj.getCartStoredItems=function(){return null!=$.cookie("cartItem_dw")&&0==form_obj.cartInLocalStorage()?$.cookie("cartItem_dw"):form_obj.cartStorage()},form_obj.cartItems=function(){if("CART"==api.getOfferType()){if("CART"==api.getOfferType()){if(null==form_obj.getCartStoredItems())return alert("No Item on cart"),form_obj.hideProgress(),!1;if(0==JSON.parse(form_obj.getCartStoredItems()).length)return alert("No Item on cart"),form_obj.hideProgress(),!1}var e=[],t=JSON.parse(form_obj.getCartStoredItems()),i=1,r=!1;for(var a in t){var n,o,s={};n=t[a].keycode,o=t[a].qty;var l=parseFloat(t[a].prodPrice)/parseInt(o),d=parseFloat(t[a].shippingPrice)/parseInt(o);void 0!==t[a].coupon&&t[a].coupon.hasOwnProperty("discounted")&&0==r&&(s.couponCode=t[a].coupon.couponCode,r=!0),s["product"+i+"_id"]=n,s["product"+i+"_price"]=l,s["product"+i+"_qty"]=o,s["product"+i+"_shipPrice"]=d,e.push(s),i++}return e}var p=[];a=1;return $("input[type='hidden'].konnecktive-order").each((function(){var e={};e["product"+a+"_id"]=$(this).val(),e["product"+a+"_price"]=$(this).attr("price"),e["product"+a+"_qty"]=$(this).attr("qty"),e["product"+a+"_shipPrice"]=$(this).attr("shippingprice"),e.billerId=$(this).attr("billerId"),p.push(e),a++})),""!=coupon_code&&p.push({couponCode:coupon_code}),p},form_obj.prefillShippingInfo=function(e){var t=e.message.data[0];$("#fields_fname").val(t.shipFirstName),$("#fields_lname").val(t.shipLastName),$("#fields_address1").val(t.shipAddress1),$("#fields_city").val(t.shipCity),$("#fields_zip").val(t.shipPostalCode),$("#fields_country_select").val(t.shipCountry).trigger("change"),$("#fields_state").val(t.shipState).trigger("change")},form_obj.updateShipping=function(e){if(0!=$("#fields_fname").length&&0!=$("#fields_lname").length){if(0==$("#update-form").length)return alert("Please add an id of #update-form that wrap the text fields"),!1;$("form").contents().unwrap(),$("#update-form").wrapInner("<form></form>"),$("form").attr("method","post"),api.queryCampaign((function(t){addCountries(t.message.data[api.getCompaignId()].countries),shippingUpdateValidation(checkoutType),form_obj.prefillShippingInfo(e)})),form_obj.submitUpdateShipping(e.message.data[0].orderId)}},form_obj.updateShippingSuccess=function(){},form_obj.submitUpdateShipping=function(e){form_obj.showProgress(),$.validator.setDefaults({ignore:[],errorPlacement:function(e,t){},invalidHandler:function(e,t){if(""!=error_msg)alert("PAGE WILL NOT PROCEED UNLESS DEVELOPER/DESIGNER WILL CORRECT THE FF:\n\n"+error_msg);else{var i="";$.each(t.errorList,(function(){i+=this.message+"\n"})),""!=i&&("undefined"!=typeof byPassExit&&(byPassExit=!1),setTimeout((function(e){alert("Please enter/correct the following required fields:\n\n"+i)}),1))}},submitHandler:function(t,i){0==wasSubmitted&&api.updateCustomer(e,(function(e){"success"==e.result.toLowerCase()?($(".cs-shipping-name").html($("#fields_fname").val()+" "+$("#fields_lname").val()),$(".shipping-address").html($("#fields_address1").val()+", "+$("#fields_city").val()+", "+$("#fields_state").val()+", "+$("#fields_zip").val()+", "+$("#fields_country_select").val()),form_obj.updateShippingSuccess()):alert(e.message),form_obj.hideProgress()}))}})},form_obj.thankyouPage=function(e){if(req_response(e)){var t;form_obj.updateShipping(e),t=1!=e.message.data.length?e.message.data[e.message.data.length-1]:e.message.data[0];var i=decodeURIComponent(getQueryStringByName("desc_individual")).split(","),r=t.hasOwnProperty("totalDiscount")?t.totalDiscount:0;$(".cs-billing-name").html(isNullOrEmpty(t.firstName)+" "+isNullOrEmpty(t.lastName)),$(".cs-shipping-name").html(isNullOrEmpty(t.shipFirstName)+" "+isNullOrEmpty(t.shipLastName)),$(".email, .cs-email").html(isNullOrEmpty(t.emailAddress)),$(".phone-number, .phone").html(isNullOrEmpty(t.phoneNumber)),$(".currencySymbol").html(t.currencySymbol),$(".currencyCode").html(t.currencyCode),$(".descriptor").html(","==getQueryStringByName("descriptor").split("").pop()?getQueryStringByName("descriptor").slice(0,-1):getQueryStringByName("descriptor")),$(".order-number").html(getQueryStringByName("orderId")),$(".totalAmount").html(t.totalAmount);var a=new Date(t.dateCreated);$(".order-date").html(a.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),""!=isNullOrEmpty(t.address1)?$(".billing-address").text(isNullOrEmpty(t.address1)+", "+isNullOrEmpty(t.city)+", "+isNullOrEmpty(t.state)+", "+isNullOrEmpty(t.postalCode)+", "+isNullOrEmpty(t.country)):$(".billing-address").text(isNullOrEmpty(t.address2)+", "+isNullOrEmpty(t.city)+", "+isNullOrEmpty(t.state)+", "+isNullOrEmpty(t.postalCode)+", "+isNullOrEmpty(t.country)),""!=isNullOrEmpty(t.shipAddress1)?$(".shipping-address").text(isNullOrEmpty(t.shipAddress1)+", "+isNullOrEmpty(t.shipCity)+", "+isNullOrEmpty(t.shipState)+", "+isNullOrEmpty(t.shipPostalCode)+", "+isNullOrEmpty(t.shipCountry)):$(".shipping-address").text(isNullOrEmpty(t.shipAddress2)+", "+isNullOrEmpty(t.shipCity)+", "+isNullOrEmpty(t.shipState)+", "+isNullOrEmpty(t.shipPostalCode)+", "+isNullOrEmpty(t.shipCountry));var n={},o=[];if("CART"==api.getOfferType()){if(null!=form_obj.getCartItemsThankyou()){var s=JSON.parse(form_obj.getCartItemsThankyou());for(var l in s){if(void 0!==s[l].coupon&&s[l].coupon.hasOwnProperty("discounted")){var d=0;d+=parseFloat(s[l].coupon.priceDiscount),d+=parseFloat(s[l].coupon.shipDiscount),s[l].productDiscount=d.toFixed(2)}void 0!==s[l].alias&&-1!=s[l].alias.toLowerCase().indexOf("subscription")?s[l].subscription=!0:s[l].subscription=!1,s[l].currencySymbol=t.currencySymbol,o.push(s[l])}}}else for(var l in t.items){for(var p in t.items[l])"name"==p&&(t.items[l].filename=t.items[l][p].toLowerCase().split(" ").join("-").replace(/([†*%?^=!:${}()|\[\]\/\\])/g,"-")),t.items[l].currencySymbol=t.currencySymbol,"productType"==p&&"OFFER"==t.items[l][p]&&(t.items[l].discountPrice=r);o.push(t.items[l])}n.ty_data=o,ty_data=o,$.cookie("confirmSent")!=t.orderId&&api.confirmOrder(),$.cookie("confirmSent",t.orderId),"undefined"!=typeof Handlebars&&0!=$("#ty-summary").length&&$(".ty-summary ").html(handleBars_compile("ty-summary",n));for(l=0;l<i.length;l++)$(".descriptor_"+l+",#descriptor_"+l).text(i[l]);form_obj.customCode(n)}else alert("ERROR:"+e.message+".");form_obj.hideProgress()},form_obj.getTyData=function(){return ty_data},form_obj.redirectionToPage=function(e,t){var i=sessionStorage.getItem("sessionId");if(null==sessionStorage.getItem(i)&&null!=i&&sessionStorage.setItem(i,1),""!=api.get_shared_page()){var r=api.get_shared_page_path();if(0!=api.get_ss_id()&&-1==api.get_ss_onSuccess().toLowerCase().indexOf("thankyou")&&t.message.cardIsPrepaid){var a="";-1!=api.get_shared_page().indexOf("/")&&(a=api.get_shared_page().substring(api.get_shared_page().lastIndexOf("/"),-1)+"/"),window.location.href=r+a+api.get_ss_onSuccess()+".html?fields_step=upsell"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString())}else 0!=form_obj.listUpsells.length?window.location.href=r+api.get_shared_page()+".html?fields_step=upsell"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString())+"&fields_fname="+t.message.firstName+"&fields_lname="+t.message.lastName:window.location.href=r+api.get_shared_page()+".html?fields_step=thankyou"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString())+"&fields_fname="+t.message.firstName+"&fields_lname="+t.message.lastName}else 0!=api.get_ss_id()&&-1==api.get_ss_onSuccess().toLowerCase().indexOf("thankyou")&&t.message.cardIsPrepaid?window.location.href=api.get_ss_onSuccess()+".html?fields_step=upsell"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString()):0!=form_obj.listUpsells.length?window.location.href="upsell.html?fields_step=upsell"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString())+"&fields_fname="+t.message.firstName+"&fields_lname="+t.message.lastName:window.location.href="thankyou.html?fields_step=thankyou"+e.params+"&descriptor="+encodeURIComponent(e.order_items.toString())+"&desc_individual="+encodeURIComponent(e.descriptor_individual.toString())+"&fields_fname="+t.message.firstName+"&fields_lname="+t.message.lastName},form_obj.secondSubmit_Callback=function(e){if(req_response(e)){var t=form_obj.cleanQueryURL(e);form_obj.redirectionToPage(t,e)}else form_obj.hideProgress(),0!=api.get_ss_id()&&-1!=e.message.toLowerCase().indexOf("prepaid")?-1!=e.message.toLowerCase().indexOf("already purchased")?alert(e.message):showStraightSaleOption():alert("ERROR: "+e.message)},form_obj.getCartStorageName=function(){var e=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")).toLowerCase().replace("/mobile",""),t=e.lastIndexOf("/");return(e=$.trim(e.substr(t).replace("/","")))==extractDomain(window.location.pathname)&&(e=""),location.hostname.trim()+"/"+e},form_obj.cartStorage=function(){return"undefined"!=typeof localStorage?localStorage.getItem(form_obj.getCartStorageName()):$.cookie("cartItem_dw")},form_obj.cartInLocalStorage=function(){var e=0,t="";return"thankyou"==getQueryStringByName("fields_step")&&(t="ty_data"),"undefined"!=typeof localStorage?null==localStorage.getItem(form_obj.getCartStorageName()+t)?0:Object.keys(JSON.parse(localStorage.getItem(form_obj.getCartStorageName()+t))).length:e},form_obj.cartItemsThankyou=function(){null!=$.cookie("cartItem_dw")&&0==form_obj.cartInLocalStorage()?($.removeCookie("ty_data"),$.cookie("ty_data",$.cookie("cartItem_dw")),$.removeCookie("cartItem_dw")):(localStorage.removeItem(form_obj.getCartStorageName()+"ty_data"),localStorage.setItem(form_obj.getCartStorageName()+"ty_data",form_obj.cartStorage()),localStorage.removeItem(form_obj.getCartStorageName()))},form_obj.getCartItemsThankyou=function(){return null!=$.cookie("cartItem_dw")&&0==form_obj.cartInLocalStorage()?$.cookie("ty_data"):localStorage.getItem(form_obj.getCartStorageName()+"ty_data")},form_obj.firstSubmit_Callback=function(e){if(req_response(e)){var t=form_obj.cleanQueryURL(e);switch("CART"==api.getOfferType()&&form_obj.cartItemsThankyou(),checkoutType){case"compact":case"normal":additional_params=updateQueryStringParameter(additional_params,"geoLookUp",""),additional_params=updateQueryStringParameter(additional_params,"orderId",e.message.orderId),additional_params=updateQueryStringParameter(additional_params,"checkoutType",api.getCheckoutType()),additional_params=updateQueryStringParameter(additional_params,"offerType",api.getOfferType().toLowerCase()),additional_params=updateQueryStringParameter(additional_params,"campaignId",e.message.campaignId),window.location.href="checkout.html?fields_step=second"+additional_params.replace("?geoLookUp","&geoLookUp")+"&fields_fname="+e.message.firstName+"&fields_lname="+e.message.lastName;break;default:form_obj.redirectionToPage(t,e)}}else form_obj.hideProgress(),0!=api.get_ss_id()&&-1!=e.message.toLowerCase().indexOf("prepaid")?-1!=e.message.toLowerCase().indexOf("already purchased")?alert(e.message):showStraightSaleOption():alert("ERROR: "+e.message)},form_obj.geoLookUpOptions=function(e){for(var t in e)geo_options[t]=e[t];return geo_options},form_obj.geoLookUp_=function(){var e=document.querySelector("#fields_phone");iti=window.intlTelInput(e,form_obj.geoLookUpOptions())},form_obj.getNumber_iti=function(){return iti.getNumber()},form_obj.submitHandler=function(){$.validator.setDefaults({ignore:[],errorPlacement:function(e,t){},invalidHandler:function(e,t){if(""!=error_msg)alert("PAGE WILL NOT PROCEED UNLESS DEVELOPER/DESIGNER WILL CORRECT THE FF:\n\n"+error_msg);else{if("CART"==api.getOfferType()){if(null==form_obj.getCartStoredItems())return alert("No Item on cart"),!1;if(0==JSON.parse(form_obj.getCartStoredItems()).length)return alert("No Item on cart"),!1}var i="";$.each(t.errorList,(function(){i+=this.message+"\n"})),""!=i&&("undefined"!=typeof byPassExit&&(byPassExit=!1),setTimeout((function(e){alert("Please enter/correct the following required fields:\n\n"+i)}),1))}},submitHandler:function(e,t){if("CART"==api.getOfferType()){if(null==form_obj.getCartStoredItems())return alert("No Item on cart"),!1;if(0==JSON.parse(form_obj.getCartStoredItems()).length)return alert("No Item on cart"),!1}if(""!=error_msg)alert("PAGE WILL NOT PROCEED UNLESS DEVELOPER/DESIGNER WILL CORRECT THE FF:\n\n"+error_msg);else if(0==wasSubmitted){wasSubmitted=!0,form_obj.showProgress(),"undefined"!=typeof byPassExit&&(byPassExit=!0);var i="";if(api.get_geoLookUp()&&(i=iti.getNumber().replace(/ /g,"").trim()),"first"==$("#fields_step").val()){additional_params="",$("#fields_address2").length>0&&(additional_params+="&fields_address2="+encodeURIComponent($("#fields_address2").val())),additional_params+="&fields_fname="+encodeURIComponent(removeExtraSpaces($("#fields_fname").val()))+"&fields_lname="+encodeURIComponent(removeExtraSpaces($("#fields_lname").val()))+"&fields_country="+encodeURIComponent($("#fields_country_select").val())+"&fields_email="+encodeURIComponent($.trim($("#fields_email").val()))+"&orderId="+encodeURIComponent($.trim($("#fields_email").val()))+"&checkoutType="+encodeURIComponent($.trim(api.getCheckoutType()))+"&offerType="+encodeURIComponent($.trim(api.getOfferType().toLowerCase()))+"&campaignId="+additionalQuery(),"compact"!=checkoutType&&(additional_params+="&fields_address1="+encodeURIComponent(removeExtraSpaces($("#fields_address1").val()))+"&fields_city="+encodeURIComponent(removeExtraSpaces($("#fields_city").val()))+"&fields_zip="+encodeURIComponent($("#fields_zip").val()),additional_params+="&fields_state="+encodeURIComponent($("#fields_state option:selected").val())),api.get_geoLookUp()?additional_params+="&fields_phone="+encodeURIComponent(iti.getNumber().replace(/ /g,"").trim()):additional_params+="&fields_phone="+encodeURIComponent($("#fields_phone").val().replace(/ /g,"").trim());var r=removeQuerystring(location.search,"fields_fname");r=removeQuerystring(r,"fields_lname"),r=removeQuerystring(r,"fields_phone"),r=removeQuerystring(r,"fields_lname"),r=removeQuerystring(r,"fields_product_name"),r=removeQuerystring(r,"fields_country"),r=removeQuerystring(r,"fields_email"),"compact"!=checkoutType&&(r=removeQuerystring(r,"fields_address1"),""!=getQueryStringByName("fields_address2")&&(r=removeQuerystring(r,"fields_address2")),r=removeQuerystring(r,"fields_city"),r=removeQuerystring(r,"fields_zip"),r=removeQuerystring(r,"fields_state")),r=removeQuerystring(r,"fields_country"),additional_params+="&"+r.replace("?",""),"one-page"==checkoutType&&0!=$("#cc_number").length?konnektiveOrderValid()?api.importOrder(form_obj.cartItems(),$("#pay_source").val(),(function(e){form_obj.firstSubmit_Callback(e)}),i):(alert("Missing Campaign Id"),form_obj.hideProgress()):"one-page"==checkoutType&&0==$("#cc_number").length?(alert("Please check the funnel, must have credit card number field for one page checkout"),form_obj.hideProgress()):api.importLead(form_obj.firstSubmit_Callback)}else if("second"==getQueryStringByName("fields_step")){if(""==getQueryStringByName("campaignId")&&0!=$("#cc_number").length)return alert("Missing Campaign Id"),form_obj.hideProgress(),!1;konnektiveOrderValid()?api.importOrder(form_obj.cartItems(),$("#pay_source").val(),(function(e){form_obj.secondSubmit_Callback(e)}),""):(alert("Missing Campaign Id"),form_obj.hideProgress())}}}})},form_obj.additionalHandlebarsFunctions=function(){},form_obj.initHandlebarsFuntions=function(){Handlebars.registerHelper("contains",(function(e,t,i){return e=Handlebars.escapeExpression(e).toLowerCase(),(t=Handlebars.escapeExpression(t)).toLowerCase().indexOf(e)>-1?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("notcontains",(function(e,t,i){return e=Handlebars.escapeExpression(e).toLowerCase(),-1==(t=Handlebars.escapeExpression(t)).toLowerCase().indexOf(e)?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("xif",(function(e,t){return Handlebars.helpers.x.apply(this,[e,t])?t.fn(this):t.inverse(this)})),Handlebars.registerHelper("len",(function(e){return Object.keys(e).length})),Handlebars.registerHelper("toFixed",(function(e){return parseFloat(e).toFixed(2)})),Handlebars.registerHelper("lowerCase",(function(e){return e.toLowerCase()})),Handlebars.registerHelper("indexOf",(function(e,t){return e.indexOf(t)})),Handlebars.registerHelper("math",(function(e,t,i,r){return arguments.length<4&&(r=i,i=t,t="+"),{"+":(e=parseFloat(e))+(i=parseFloat(i)),"-":e-i,"*":e*i,"/":e/i,"%":e%i}[t].toFixed(2)})),Handlebars.registerHelper("ifCond",(function(e,t,i,r){switch(t){case"==":return e==i?r.fn(this):r.inverse(this);case"===":return e===i?r.fn(this):r.inverse(this);case"!=":return e!=i?r.fn(this):r.inverse(this);case"!==":return e!==i?r.fn(this):r.inverse(this);case"<":return e<i?r.fn(this):r.inverse(this);case"<=":return e<=i?r.fn(this):r.inverse(this);case">":return e>i?r.fn(this):r.inverse(this);case">=":return e>=i?r.fn(this):r.inverse(this);case"&&":return e&&i?r.fn(this):r.inverse(this);case"||":return e||i?r.fn(this):r.inverse(this);default:return r.inverse(this)}})),Handlebars.registerHelper("x",(function(expression,options){var result,context=this;with(context)result=function(){try{return eval(expression)}catch(e){console.warn("•Expression: {{x '"+expression+"'}}\n•JS-Error: ",e,"\n•Context: ",context)}}.call(context);return result})),Handlebars.registerHelper("xif",(function(e,t){return Handlebars.helpers.x.apply(this,[e,t])?t.fn(this):t.inverse(this)}))},form_obj.exec=function(){form_obj.showProgress(),$(document).ready((function(){if("undefined"!=typeof Handlebars&&(form_obj.initHandlebarsFuntions(),form_obj.additionalHandlebarsFunctions()),"undefined"==typeof intlTelInput&&api.get_geoLookUp())return alert("Error: You're using geoLookUp but required script is not loaded successfully.Please add the ff. required script and style in your page:\n\n- <script src='/onlineorder/js/konnek.api/build/js/intlTelInput.min.js'><\/script>\n- <link rel='stylesheet' href='/onlineorder/js/konnek.api/build/css/intlTelInput.min.css'>"),!1;if(void 0===api)return alert("Error: Please pass KonnekApiInit() function as parameter to KonnekForm() function."),!1;if(1==api.get_psmrToBoss()&&""==api.get_psmrBoss_key()&&0!=api.get_psmr_prod_id())return alert("Page has psmr but psmr api key is empty. Please add it."),!1;if(""==getQueryStringByName("paypalAccept")&&""!=getQueryStringByName("token"))null!=sessionStorage.getItem("redirection_paypal")&&(window.location.href=sessionStorage.getItem("redirection_paypal"));else if("1"==getQueryStringByName("paypalAccept"))if(""!=getQueryStringByName("fields_step")&&"second"!=getQueryStringByName("fields_step")||0!=$("#yes-upsell-relink").length||-1!=location.pathname.toLowerCase().indexOf("/shared_pages/")||-1!=location.pathname.toLowerCase().indexOf("/shared_pages")||-1!=location.pathname.toLowerCase().indexOf("upsell.html"))form_obj.PageEvent("upsell");else{var e=[];e.push(JSON.parse(sessionStorage.getItem("paypalExpress"))),api.confirmPaypal(e,(function(t){"success"==t.result.toLowerCase()?(api.setCompaignId(e[0].campaignId),api.queryCampaign((function(i){form_obj.listUpsells=getProductOffers(i.message.data[e[0].campaignId].products,"UPSALE"),"second"==getQueryStringByName("fields_step")?form_obj.secondSubmit_Callback(t):form_obj.firstSubmit_Callback(t)}))):(alert(t.message),form_obj.hideProgress(),window.location.href=sessionStorage.getItem("redirection_paypal"))}))}else 0==$("#fields_fname").length&&0==$("#cc_number").length&&""==getQueryStringByName("fields_step")?checkCampaignID()&&(""!=getQueryStringByName("PayerID")&&""!=getQueryStringByName("paypalAccept")||api.importClick(),api.queryCampaign((function(){var e=location.search;e=removeQuerystring(e,"campaignId"),e=removeQuerystring(e,"checkoutType"),e=removeQuerystring(e,"offerType"),$("a").unbind(),$("a").each((function(){var t=$(this).attr("href");hasQueryURL()?$(this).attr("href",t+e+"&campaignId="+api.getCompaignId()+"&checkoutType="+api.getCheckoutType()+"&offerType="+api.getOfferType().toLowerCase()+additionalQuery()):$(this).attr("href",t+"?campaignId="+api.getCompaignId()+"&checkoutType="+api.getCheckoutType()+"&offerType="+api.getOfferType().toLowerCase()+additionalQuery())})),$("#is_intro").length>0&&"1"==$("#is_intro").val()&&form_obj.PageEvent("welcome"),form_obj.hideProgress()}))):checkCampaignID()&&form_obj.initPage()}))},form_obj},init="KonnekForm";"function"!=typeof window[init]&&(window[init]=Form)})();